<!DOCTYPE html>
<!-- saved from url=(0108)https://towardsdatascience.com/quantile-regression-from-linear-models-to-trees-to-deep-learning-af3738b527c3 -->
<html lang="en" data-rh="lang"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><script async="" src="./Quantile regression, from linear models to trees to deep learning_files/branch-latest.min.js.download"></script><script async="" src="./Quantile regression, from linear models to trees to deep learning_files/analytics.js.download"></script><script>!function(c,f){var t,o,i,e=[],r={passive:!0,capture:!0},n=new Date,a="pointerup",u="pointercancel";function p(n,e){t||(t=e,o=n,i=new Date,w(f),s())}function s(){0<=o&&o<i-n&&(e.forEach(function(n){n(o,t)}),e=[])}function l(n){if(n.cancelable){var e=(1e12<n.timeStamp?new Date:performance.now())-n.timeStamp;"pointerdown"==n.type?function(n,e){function t(){p(n,e),i()}function o(){i()}function i(){f(a,t,r),f(u,o,r)}c(a,t,r),c(u,o,r)}(e,n):p(e,n)}}function w(e){["click","mousedown","keydown","touchstart","pointerdown"].forEach(function(n){e(n,l,r)})}w(c),self.perfMetrics=self.perfMetrics||{},self.perfMetrics.onFirstInputDelay=function(n){e.push(n),s()}}(addEventListener,removeEventListener)</script><script defer="" src="./Quantile regression, from linear models to trees to deep learning_files/16180790160.js.download"></script><title>Quantile regression, from linear models to trees to deep learning</title><meta data-rh="true" name="viewport" content="width=device-width,minimum-scale=1,initial-scale=1"><meta data-rh="true" name="theme-color" content="#000000"><meta data-rh="true" name="twitter:app:name:iphone" content="Medium"><meta data-rh="true" name="twitter:app:id:iphone" content="828256236"><meta data-rh="true" property="al:ios:app_name" content="Medium"><meta data-rh="true" property="al:ios:app_store_id" content="828256236"><meta data-rh="true" property="al:android:package" content="com.medium.reader"><meta data-rh="true" property="fb:app_id" content="542599432471018"><meta data-rh="true" property="og:site_name" content="Medium"><meta data-rh="true" property="og:type" content="article"><meta data-rh="true" property="article:published_time" content="2020-01-18T17:38:17.509Z"><meta data-rh="true" name="title" content="Quantile regression, from linear models to trees to deep learning"><meta data-rh="true" property="og:title" content="Quantile regression, from linear models to trees to deep learning"><meta data-rh="true" property="twitter:title" content="Quantile regression, from linear models to trees to deep learning"><meta data-rh="true" name="twitter:site" content="@TDataScience"><meta data-rh="true" name="twitter:app:url:iphone" content="medium://p/af3738b527c3"><meta data-rh="true" property="al:android:url" content="medium://p/af3738b527c3"><meta data-rh="true" property="al:ios:url" content="medium://p/af3738b527c3"><meta data-rh="true" property="al:android:app_name" content="Medium"><meta data-rh="true" name="description" content="Suppose a real estate analyst wants to predict home prices from factors like home age and distance from job centers. The typical goal will be generating the best home price point estimate given those…"><meta data-rh="true" property="og:description" content="Suppose a real estate analyst wants to predict home prices from factors like home age and distance from job centers. The typical goal will…"><meta data-rh="true" property="twitter:description" content="Suppose a real estate analyst wants to predict home prices from factors like home age and distance from job centers. The typical goal will…"><meta data-rh="true" property="og:url" content="https://towardsdatascience.com/quantile-regression-from-linear-models-to-trees-to-deep-learning-af3738b527c3"><meta data-rh="true" property="al:web:url" content="https://towardsdatascience.com/quantile-regression-from-linear-models-to-trees-to-deep-learning-af3738b527c3"><meta data-rh="true" property="og:image" content="https://miro.medium.com/max/1131/0*ufWnnvTA9AkjKrfI"><meta data-rh="true" name="twitter:image:src" content="https://miro.medium.com/max/1131/0*ufWnnvTA9AkjKrfI"><meta data-rh="true" name="twitter:card" content="summary_large_image"><meta data-rh="true" property="article:author" content="https://towardsdatascience.com/@MaxGhenis"><meta data-rh="true" name="twitter:creator" content="@maxghenis"><meta data-rh="true" name="author" content="Max Ghenis"><meta data-rh="true" name="robots" content="index,follow"><meta data-rh="true" name="referrer" content="unsafe-url"><meta data-rh="true" name="twitter:label1" value="Reading time"><meta data-rh="true" name="twitter:data1" value="8 min read"><meta data-rh="true" name="parsely-post-id" content="af3738b527c3"><link data-rh="true" rel="search" type="application/opensearchdescription+xml" title="Medium" href="https://towardsdatascience.com/osd.xml"><link data-rh="true" rel="apple-touch-icon" sizes="152x152" href="https://cdn-images-1.medium.com/fit/c/152/152/1*8I-HPL0bfoIzGied-dzOvA.png"><link data-rh="true" rel="apple-touch-icon" sizes="120x120" href="https://cdn-images-1.medium.com/fit/c/120/120/1*8I-HPL0bfoIzGied-dzOvA.png"><link data-rh="true" rel="apple-touch-icon" sizes="76x76" href="https://cdn-images-1.medium.com/fit/c/76/76/1*8I-HPL0bfoIzGied-dzOvA.png"><link data-rh="true" rel="apple-touch-icon" sizes="60x60" href="https://cdn-images-1.medium.com/fit/c/60/60/1*8I-HPL0bfoIzGied-dzOvA.png"><link data-rh="true" rel="mask-icon" href="https://cdn-static-1.medium.com/_/fp/icons/monogram-mask.KPLCSFEZviQN0jQ7veN2RQ.svg" color="#171717"><link data-rh="true" id="glyph_link" rel="stylesheet" type="text/css" href="./Quantile regression, from linear models to trees to deep learning_files/m2.css"><link data-rh="true" rel="author" href="https://towardsdatascience.com/@MaxGhenis"><link data-rh="true" rel="canonical" href="https://towardsdatascience.com/quantile-regression-from-linear-models-to-trees-to-deep-learning-af3738b527c3"><link data-rh="true" rel="alternate" href="android-app://com.medium.reader/https/medium.com/p/af3738b527c3"><script data-rh="true">(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
ga('create', 'UA-24232453-2', 'auto');
ga('send', 'pageview');</script><link rel="preload" href="./Quantile regression, from linear models to trees to deep learning_files/16180790160.js.download" as="script"><style type="text/css" data-fela-rehydration="490" data-fela-type="STATIC">html{box-sizing:border-box}*, *:before, *:after{box-sizing:inherit}body{margin:0;padding:0;text-rendering:optimizeLegibility;-webkit-font-smoothing:antialiased;color:rgba(0,0,0,0.8);position:relative;min-height:100vh}h1, h2, h3, h4, h5, h6, dl, dd, ol, ul, menu, figure, blockquote, p, pre, form{margin:0}menu, ol, ul{padding:0;list-style:none;list-style-image:none}main{display:block}a{color:inherit;text-decoration:none}a, button, input{-webkit-tap-highlight-color:transparent}img, svg{vertical-align:middle}button{background:transparent;overflow:visible}button, input, optgroup, select, textarea{margin:0}</style><style type="text/css" data-fela-rehydration="490" data-fela-type="KEYFRAME">@-webkit-keyframes k1{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@-moz-keyframes k1{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@keyframes k1{0%{transform:scale(1)}50%{transform:scale(1.1)}100%{transform:scale(1)}}@-webkit-keyframes k2{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@-moz-keyframes k2{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}@keyframes k2{0%{transform:scale(1);opacity:1}70%{transform:scale(1.4);opacity:0}100%{opacity:0}}</style><style type="text/css" data-fela-rehydration="490" data-fela-type="RULE">.a{font-family:medium-content-sans-serif-font, -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen, Ubuntu, Cantarell, "Open Sans", "Helvetica Neue", sans-serif}.b{font-weight:400}.c{background-color:rgba(255, 255, 255, 1)}.l{height:100vh}.m{width:100vw}.n{display:flex}.o{align-items:center}.p{justify-content:center}.q{fill:rgba(41, 41, 41, 1)}.r{display:block}.s{position:absolute}.t{top:0}.u{left:0}.v{right:0}.w{z-index:500}.x{box-shadow:0 4px 12px 0 rgba(0, 0, 0, 0.05)}.ag{max-width:1192px}.ah{min-width:0}.ai{width:100%}.aj{height:65px}.am{flex:1 0 auto}.an{fill:rgba(25, 25, 25, 1)}.ao{visibility:hidden}.ap{margin-left:16px}.aq{display:none}.as{color:rgba(90, 118, 144, 1)}.at{fill:rgba(102, 138, 170, 1)}.au{font-size:inherit}.av{border:inherit}.aw{font-family:inherit}.ax{letter-spacing:inherit}.ay{font-weight:inherit}.az{padding:0}.ba{margin:0}.bb:hover{cursor:pointer}.bc:hover{color:rgba(84, 108, 131, 1)}.bd:hover{fill:rgba(90, 118, 144, 1)}.be:disabled{cursor:default}.bf:disabled{color:rgba(140, 93, 255, 0.5)}.bg:disabled{fill:rgba(140, 93, 255, 0.5)}.bh{flex:0 0 auto}.bi{font-family:medium-content-sans-serif-font, "Lucida Grande", "Lucida Sans Unicode", "Lucida Sans", Geneva, Arial, sans-serif}.bj{font-style:normal}.bk{line-height:20px}.bl{font-size:15.8px}.bm{letter-spacing:0px}.bn{color:rgba(117, 117, 117, 1)}.bo{fill:rgba(117, 117, 117, 1)}.bp{justify-content:flex-end}.bq{margin-top:16px}.br{margin-bottom:16px}.bs{display:inherit}.bt{max-width:210px}.bu{text-overflow:ellipsis}.bv{overflow:hidden}.bw{white-space:nowrap}.bx{display:inline-block}.by{border:none}.bz{outline:none}.ca{font:inherit}.cb{font-size:16px}.cc{opacity:0}.cd{position:relative}.ce{width:0px}.cf{transition:width 140ms ease-in}.cg{color:inherit}.ch{fill:inherit}.ci:hover{color:rgba(25, 25, 25, 1)}.cj:hover{fill:rgba(25, 25, 25, 1)}.ck:disabled{color:rgba(117, 117, 117, 1)}.cl:disabled{fill:rgba(117, 117, 117, 1)}.cm{margin-right:10px}.cq{margin-right:16px}.cr{margin:15px 0}.cs{padding:4px 12px}.ct{color:rgba(41, 41, 41, 1)}.cu{background:0}.cv{border-color:rgba(117, 117, 117, 1)}.cw:hover{color:rgba(8, 8, 8, 1)}.cx:hover{fill:rgba(8, 8, 8, 1)}.cy:hover{border-color:rgba(41, 41, 41, 1)}.cz:disabled{fill:rgba(61, 61, 61, 1)}.da:disabled{border-color:rgba(204, 204, 204, 1)}.db:disabled{cursor:inherit}.dc:disabled:hover{color:rgba(117, 117, 117, 1)}.dd:disabled:hover{fill:rgba(61, 61, 61, 1)}.de:disabled:hover{border-color:rgba(204, 204, 204, 1)}.df{border-radius:4px}.dg{border-width:1px}.dh{border-style:solid}.di{box-sizing:border-box}.dj{text-decoration:none}.dk{padding-bottom:10px}.dl{padding-top:10px}.dm{border-radius:50%}.dn{height:32px}.do{width:32px}.dp{border-top:none}.dq{background-color:rgba(53, 88, 118, 1)}.dr{height:54px}.ds{margin-right:40px}.dt{height:36px}.du{width:100px}.dv{overflow:auto}.dw{flex:0 1 auto}.dx{list-style-type:none}.dy{line-height:40px}.dz{overflow-x:auto}.ea{align-items:flex-start}.eb{margin-top:20px}.ec{padding-top:20px}.ed{height:80px}.ee{height:20px}.ef{margin-right:15px}.eg{margin-left:15px}.eh:first-child{margin-left:0}.ei{min-width:1px}.ej{background-color:rgba(197, 210, 225, 1)}.ek{font-weight:300}.el{font-size:15px}.em{color:rgba(197, 210, 225, 1)}.en{text-transform:uppercase}.eo{letter-spacing:1px}.ep:hover{color:rgba(251, 255, 255, 1)}.eq:hover{fill:rgba(233, 241, 250, 1)}.er:disabled{color:rgba(150, 171, 191, 1)}.es:disabled{fill:rgba(150, 171, 191, 1)}.et{margin-bottom:0px}.eu{height:119px}.ex{padding-left:24px}.ey{padding-right:24px}.ez{margin-left:auto}.fa{margin-right:auto}.fb{max-width:728px}.fc{top:calc(100vh + 100px)}.fd{bottom:calc(100vh + 100px)}.fe{width:10px}.ff{pointer-events:none}.fg{word-break:break-word}.fh{word-wrap:break-word}.fi:after{display:block}.fj:after{content:""}.fk:after{clear:both}.fl{max-width:680px}.fm{line-height:1.23}.fn{letter-spacing:0}.fo{font-family:medium-content-title-font, Georgia, Cambria, "Times New Roman", Times, serif}.fz{margin-bottom:-0.27em}.gf{margin-top:32px}.gg{justify-content:space-between}.gk{width:48px}.gl{height:48px}.gm{fill:rgba(3, 168, 124, 1)}.gn{flex-direction:row}.go{width:calc(100% + 25px)}.gp{height:calc(100% + 25px)}.gq{top:50%}.gr{left:50%}.gs{transform:translateX(-50%) translateY(-50%)}.gt{margin-left:12px}.gu{margin-bottom:2px}.gw{max-height:20px}.gx{display:-webkit-box}.gy{-webkit-line-clamp:1}.gz{-webkit-box-orient:vertical}.ha:hover{text-decoration:underline}.hb{margin-left:8px}.hc{padding:0px 8px}.hd{border-color:rgba(102, 138, 170, 1)}.he:hover{border-color:rgba(90, 118, 144, 1)}.hf{line-height:18px}.hg{align-items:flex-end}.ho{padding-right:6px}.hp{margin-right:8px}.hq{fill:rgba(61, 61, 61, 1)}.hr{margin-right:-6px}.hs{line-height:1.58}.ht{letter-spacing:-0.004em}.hu{font-family:medium-content-serif-font, Georgia, Cambria, "Times New Roman", Times, serif}.if{margin-bottom:-0.46em}.ig{letter-spacing:-0.003em}.im{font-style:italic}.in{background-repeat:repeat-x}.io{background-image:linear-gradient(to right,rgba(41, 41, 41, 1) 100%,rgba(41, 41, 41, 1) 0);background-image:url('data:image/svg+xml;utf8,<svg preserveAspectRatio="none" viewBox="0 0 1 1" xmlns="http://www.w3.org/2000/svg"><line x1="0" y1="0" x2="1" y2="1" stroke="rgba(41, 41, 41, 1)" /></svg>')}.ip{background-size:1px 1px}.iq{background-position:0 1.05em;background-position:0 calc(1em + 1px)}.ir{line-height:1.12}.is{letter-spacing:-0.022em}.it{font-weight:600}.jc{margin-bottom:-0.28em}.ji{max-width:1131px}.jo{clear:both}.jp{transition:transform 300ms cubic-bezier(0.2, 0, 0.2, 1)}.jq{cursor:zoom-in}.jr{z-index:auto}.js{transition:opacity 100ms 400ms}.jt{height:100%}.ju{will-change:transform}.jv{transform:translateZ(0)}.jw{margin:auto}.jx{background-color:rgba(242, 242, 242, 1)}.jy{padding-bottom:79.04509283819628%}.jz{height:0}.ka{filter:blur(20px)}.kb{transform:scale(1.1)}.kc{visibility:visible}.kd{background:rgba(255, 255, 255, 1)}.ke{list-style-type:disc}.kf{margin-left:30px}.kg{padding-left:0px}.kh{font-weight:700}.kn{max-width:284px}.ko{padding-bottom:20.070422535211264%}.kp{padding:2px 4px}.kq{font-size:75%}.kr> strong{font-family:inherit}.ks{font-family:Menlo, Monaco, "Courier New", Courier, monospace}.kt{padding:20px}.ku{background:rgba(242, 242, 242, 1)}.kv{line-height:1.18}.kw{margin-top:-0.09em}.kx{margin-bottom:-0.09em}.ky{white-space:pre-wrap}.kz{max-width:1153px}.la{padding-bottom:77.62359063313096%}.lb{max-width:1187px}.lc{padding-bottom:75.31592249368154%}.ld{background:none}.le{max-width:1275px}.lf{padding-bottom:70.11764705882354%}.lg{max-width:1291px}.lh{padding-bottom:69.24864446165763%}.li{font-family:medium-content-slab-serif-font, Georgia, Cambria, "Times New Roman", Times, serif}.lj{font-size:28px}.lk{color:rgba(8, 8, 8, 1)}.ll{margin-top:30px}.lm{text-align:center}.ln:before{content:"..."}.lo:before{letter-spacing:0.6em}.lp:before{text-indent:0.6em}.lq:before{font-style:italic}.lr:before{line-height:1.4}.ls{will-change:opacity}.lt{position:fixed}.lu{top:calc(65px + 54px + 40px)}.lx{width:188px}.ly{transform:translateX(406px)}.lz{top:calc(65px + 54px + 14px)}.mb{width:131px}.mc{flex-direction:column}.md{padding-bottom:28px}.me{border-bottom:1px solid rgba(230, 230, 230, 1)}.mf{font-size:18px}.mg{padding-bottom:20px}.mh{padding-top:2px}.mi{max-height:120px}.mj{-webkit-line-clamp:6}.mk{padding-top:28px}.ml{margin-bottom:19px}.mm{margin-left:-3px}.ms{outline:0}.mt{border:0}.mu{user-select:none}.mv{cursor:pointer}.mw> svg{pointer-events:none}.mx:active{border-style:none}.my{-webkit-user-select:none}.mz:focus{fill:rgba(117, 117, 117, 1)}.na:hover{fill:rgba(117, 117, 117, 1)}.ni button{text-align:left}.nj{margin-top:40px}.nk{flex-wrap:wrap}.nl{margin-top:25px}.nm{margin-bottom:8px}.nn{border-radius:3px}.no{padding:5px 10px}.np{line-height:22px}.nq{margin-top:15px}.nr{max-width:155px}.nx{border:1px solid rgba(230, 230, 230, 1)}.ny{height:60px}.nz{width:60px}.om:hover{border-color:rgba(117, 117, 117, 1)}.on:active{border-style:solid}.oo{z-index:2}.oq{top:1px}.ow{padding-right:8px}.ox{padding-top:32px}.oy{border-top:1px solid rgba(230, 230, 230, 1)}.oz{margin-bottom:25px}.pb{margin-bottom:32px}.pc{min-height:80px}.ph{width:80px}.pi{padding-left:102px}.pk{letter-spacing:0.05em}.pl{margin-bottom:6px}.pm{line-height:36px}.pn{max-width:555px}.po{max-width:450px}.pp{line-height:24px}.pr{max-width:550px}.ps{padding-top:24px}.pt{margin-top:5px}.pu{width:40px}.pv{height:40px}.pw{font-size:12px}.px{line-height:15px}.py{padding-top:8px}.pz{padding-top:25px}.qb{color:rgba(61, 61, 61, 1)}.qc{opacity:1}.qd{border:1px solid rgba(102, 138, 170, 1)}.qe{margin-top:64px}.qf{background-color:rgba(250, 250, 250, 1)}.qg{padding:60px 0}.qh{background-color:rgba(0, 0, 0, 0.9)}.qy{padding-bottom:48px}.qz{border-bottom:1px solid rgba(255, 255, 255, 0.54)}.ra{margin:0 -12px}.rb{margin:0 12px}.rc{flex:1 1 0}.rd{padding-bottom:12px}.re:hover{color:rgba(255, 255, 255, 0.99)}.rf:hover{fill:rgba(255, 255, 255, 0.99)}.rg:disabled{color:rgba(255, 255, 255, 0.7)}.rh:disabled{fill:rgba(255, 255, 255, 0.7)}.ri{color:rgba(255, 255, 255, 0.98)}.rj{fill:rgba(255, 255, 255, 0.98)}.rk{text-align:inherit}.rl{font-size:21.6px}.rm{letter-spacing:-0.32px}.rn{color:rgba(255, 255, 255, 0.7)}.ro{fill:rgba(255, 255, 255, 0.7)}.rp{text-decoration:underline}.rq{padding-bottom:8px}.rr{width:200px}.rx:disabled{color:rgba(3, 168, 124, 0.5)}.ry:disabled{fill:rgba(3, 168, 124, 0.5)}.rz{-webkit-user-select:none}</style><style type="text/css" data-fela-rehydration="490" data-fela-type="RULE" media="all and (min-width: 1080px)">.d{display:none}.af{margin:0 64px}.fx{font-size:40px}.fy{margin-top:0.78em}.ge{line-height:48px}.hn{margin-left:30px}.id{font-size:21px}.ie{margin-top:2em}.il{line-height:32px}.ja{font-size:34px}.jb{margin-top:1.95em}.jh{margin-top:0.86em}.jn{margin-top:56px}.km{margin-top:1.05em}.mr{margin-right:5px}.nh{margin-top:5px}.nw{margin-right:16px}.ov{width:25px}.qv{padding-left:64px}.qw{padding-right:64px}.qx{max-width:1320px}</style><style type="text/css" data-fela-rehydration="490" data-fela-type="RULE" media="all and (max-width: 1079.98px)">.e{display:none}.hm{margin-left:30px}.mq{margin-right:5px}.ng{margin-top:5px}.nv{margin-right:16px}.ou{width:25px}.qs{padding-left:64px}.qt{padding-right:64px}.qu{max-width:1080px}</style><style type="text/css" data-fela-rehydration="490" data-fela-type="RULE" media="all and (max-width: 903.98px)">.f{display:none}.cp{display:flex}.hl{margin-left:30px}.mp{margin-right:5px}.nf{margin-top:5px}.nu{margin-right:16px}.ot{width:15px}.qp{padding-left:48px}.qq{padding-right:48px}.qr{max-width:904px}</style><style type="text/css" data-fela-rehydration="490" data-fela-type="RULE" media="all and (max-width: 727.98px)">.g{display:none}.ak{height:56px}.al{display:flex}.ar{display:block}.cn{margin-left:10px}.co{margin-right:10px}.ev{margin-bottom:0px}.ew{height:110px}.gi{margin-top:32px}.gj{flex-direction:column-reverse}.hj{margin-bottom:30px}.hk{margin-left:0px}.mo{margin-left:8px}.nd{margin-top:2px}.ne{margin-right:8px}.nt{margin-left:16px}.os{width:15px}.pa{padding-top:0}.pd{margin-bottom:24px}.pe{align-items:center}.pf{width:102px}.pg{position:relative}.pj{padding-left:0}.pq{margin-top:24px}.qa{border-top:none}.qi{padding:32px 0}.qm{padding-left:24px}.qn{padding-right:24px}.qo{max-width:728px}.rs{width:140px}.rt{margin-bottom:16px}.ru{margin-top:30px}.rv{width:100%}.rw{flex-direction:row}</style><style type="text/css" data-fela-rehydration="490" data-fela-type="RULE" media="all and (max-width: 551.98px)">.h{display:none}.z{margin:0 24px}.fp{font-size:30px}.fq{margin-top:0.72em}.ga{line-height:40px}.gh{margin-top:32px}.gv{margin-bottom:0px}.hh{margin-bottom:30px}.hi{margin-left:0px}.hv{font-size:18px}.hw{margin-top:1.56em}.ih{line-height:28px}.iu{margin-top:1.2em}.jd{margin-top:0.67em}.jj{margin-top:40px}.ki{margin-top:1.34em}.mn{margin-left:8px}.nb{margin-top:2px}.nc{margin-right:8px}.ns{margin-left:16px}.or{width:15px}.qj{padding-left:24px}.qk{padding-right:24px}.ql{max-width:552px}</style><style type="text/css" data-fela-rehydration="490" data-fela-type="RULE" media="all and (min-width: 904px) and (max-width: 1079.98px)">.i{display:none}.ae{margin:0 64px}.fv{font-size:40px}.fw{margin-top:0.78em}.gd{line-height:48px}.ib{font-size:21px}.ic{margin-top:2em}.ik{line-height:32px}.iy{font-size:34px}.iz{margin-top:1.95em}.jg{margin-top:0.86em}.jm{margin-top:56px}.kl{margin-top:1.05em}</style><style type="text/css" data-fela-rehydration="490" data-fela-type="RULE" media="all and (min-width: 728px) and (max-width: 903.98px)">.j{display:none}.ac{margin:0 48px}.ft{font-size:40px}.fu{margin-top:0.78em}.gc{line-height:48px}.hz{font-size:21px}.ia{margin-top:2em}.ij{line-height:32px}.iw{font-size:34px}.ix{margin-top:1.95em}.jf{margin-top:0.86em}.jl{margin-top:56px}.kk{margin-top:1.05em}</style><style type="text/css" data-fela-rehydration="490" data-fela-type="RULE" media="all and (min-width: 552px) and (max-width: 727.98px)">.k{display:none}.ab{margin:0 24px}.fr{font-size:30px}.fs{margin-top:0.72em}.gb{line-height:40px}.hx{font-size:18px}.hy{margin-top:1.56em}.ii{line-height:28px}.iv{margin-top:1.2em}.je{margin-top:0.67em}.jk{margin-top:40px}.kj{margin-top:1.34em}</style><style type="text/css" data-fela-rehydration="490" data-fela-type="RULE" media="print">.y{display:none}</style><style type="text/css" data-fela-rehydration="490" data-fela-type="RULE" media="(prefers-reduced-motion: no-preference)">.lv{transition:opacity 200ms}.oa{transition:border-color 150ms ease}.ob::before{background:
      radial-gradient(circle, rgba(41, 41, 41, 1) 60%, transparent 70%)
    }.oc::before{border-radius:50%}.od::before{content:""}.oe::before{display:block}.of::before{z-index:0}.og::before{left:0}.oh::before{height:100%}.oi::before{position:absolute}.oj::before{top:0}.ok::before{width:100%}.ol:hover::before{animation:k2 2000ms infinite cubic-bezier(.1,.12,.25,1)}.op{transition:fill 200ms ease}</style><style type="text/css" data-fela-rehydration="490" data-fela-type="RULE" media="all and (max-width: 1198px)">.lw{display:none}</style><style type="text/css" data-fela-rehydration="490" data-fela-type="RULE" media="all and (max-width: 1230px)">.ma{display:none}</style><link rel="icon" href="https://miro.medium.com/fit/c/192/192/1*ChFMdf--f5jbm-AYv6VdYA@2x.png" data-rh="true"><script type="application/ld+json" data-rh="true">{"@context":"http:\u002F\u002Fschema.org","@type":"NewsArticle","image":["https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F1200\u002F0*ufWnnvTA9AkjKrfI"],"url":"https:\u002F\u002Ftowardsdatascience.com\u002Fquantile-regression-from-linear-models-to-trees-to-deep-learning-af3738b527c3","dateCreated":"2018-10-16T23:34:08.253Z","datePublished":"2018-10-16T23:34:08.253Z","dateModified":"2020-01-18T17:38:17.954Z","headline":"Quantile regression, from linear models to trees to deep learning","name":"Quantile regression, from linear models to trees to deep learning","description":"Suppose a real estate analyst wants to predict home prices from factors like home age and distance from job centers. The typical goal will be generating the best home price point estimate given those…","identifier":"af3738b527c3","keywords":["Lite:true","Tag:Machine Learning","Tag:Predictive Analytics","Tag:Deep Learning","Tag:Regression","Tag:TensorFlow","Topic:Machine Learning","Topic:Data Science","Publication:towards-data-science","Elevated:false","LockedPostSource:LOCKED_POST_SOURCE_NONE","LayerCake:3"],"author":{"@type":"Person","name":"Max Ghenis","url":"https:\u002F\u002Ftowardsdatascience.com\u002F@MaxGhenis"},"creator":["Max Ghenis"],"publisher":{"@type":"Organization","name":"Towards Data Science","url":"towardsdatascience.com","logo":{"@type":"ImageObject","width":165,"height":60,"url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F248\u002F1*mG6i4Bh_LgixUYXJgQpYsg@2x.png"}},"mainEntityOfPage":"https:\u002F\u002Ftowardsdatascience.com\u002Fquantile-regression-from-linear-models-to-trees-to-deep-learning-af3738b527c3"}</script><script type="text/javascript" data-rh="true">(function(b,r,a,n,c,h,_,s,d,k){if(!b[n]||!b[n]._q){for(;s<_.length;)c(h,_[s++]);d=r.createElement(a);d.async=1;d.src="https://cdn.branch.io/branch-latest.min.js";k=r.getElementsByTagName(a)[0];k.parentNode.insertBefore(d,k);b[n]=h}})(window,document,"script","branch",function(b,r){b[r]=function(){b._q.push([r,arguments])}},{_q:[],_v:1},"addListener applyCode autoAppIndex banner closeBanner closeJourney creditHistory credits data deepview deepviewCta first getCode init link logout redeem referrals removeListener sendSMS setBranchViewData setIdentity track validateCode trackCommerceEvent logEvent".split(" "), 0);
branch.init('key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm', {metadata: {}, 'no_journeys': true, 'disable_exit_animation': true, 'disable_entry_animation': true, 'tracking_disabled': null}, function(err, data) {});</script></head><body data-gr-c-s-loaded="true"><div id="root"><div class="a b c"><div class="d e f g h i j k"></div><script>document.domain = document.domain;</script><div><script>if (window.self !== window.top) window.location = "about:blank"</script></div><script>window.PARSELY = window.PARSELY || {autotrack: false}</script><nav class="r s t u v c w x y"><div><div class="r c"><div class="n p"><div class="z ab ac ae af ag ah ai"><div class="aj n o ak al"><div class="n o am w"><a href="https://medium.com/?source=post_page-----af3738b527c3----------------------" aria-label="Homepage" rel="noopener"><svg width="35" height="35" viewBox="5 5 35 35" class="an"><path d="M5 40V5h35v35H5zm8.56-12.63c0 .56-.03.69-.32 1.03L10.8 31.4v.4h6.97v-.4L15.3 28.4c-.29-.34-.34-.5-.34-1.03v-8.95l6.13 13.36h.71l5.26-13.36v10.64c0 .3 0 .35-.19.53l-1.85 1.8v.4h9.2v-.4l-1.83-1.8c-.18-.18-.2-.24-.2-.53V15.94c0-.3.02-.35.2-.53l1.82-1.8v-.4h-6.47l-4.62 11.55-5.2-11.54h-6.8v.4l2.15 2.63c.24.3.29.37.29.77v10.35z"></path></svg></a><div class="kc" id="li-general-navbar-open-in-app-button"><div class="ap aq ar"><a href="https://rsci.app.link/?%24canonical_url=https%3A%2F%2Fmedium.com%2Fp%2Faf3738b527c3&amp;~feature=LiOpenInAppButton&amp;~channel=ShowPostUnderCollection&amp;~stage=mobileNavBar&amp;source=post_page-----af3738b527c3----------------------" class="as at au av aw ax ay az ba bb bc bd be bf bg" rel="noopener nofollow">Open in app</a></div></div></div><div class="r bh w"><span class="bi b bj bk bl bm r bn bo"><div class="n o bp"><div class="n f"><div class="bx" aria-hidden="true"><div class="n"><button class="cg ch au av aw ax ay az ba bb ci cj be ck cl"><svg width="25" height="25" viewBox="0 0 25 25" class="ap cm r cn co"><path d="M20.07 18.93l-4.16-4.15a6 6 0 1 0-.88.88l4.15 4.16a.62.62 0 1 0 .89-.89zM6.5 11a4.75 4.75 0 1 1 9.5 0 4.75 4.75 0 0 1-9.5 0z"></path></svg></button><input class="by bz ca cb bk cc cd ce cf" placeholder="Search Towards Data Science" value=""></div></div></div><div class="aq cp"><a href="https://towardsdatascience.com/search?source=post_page-----af3738b527c3----------------------" class="cg ch au av aw ax ay az ba bb ci cj be ck cl" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25" class="ap cq r cn co"><path d="M20.07 18.93l-4.16-4.15a6 6 0 1 0-.88.88l4.15 4.16a.62.62 0 1 0 .89-.89zM6.5 11a4.75 4.75 0 1 1 9.5 0 4.75 4.75 0 0 1-9.5 0z"></path></svg></a></div><a href="https://medium.com/me/list/queue?source=post_page-----af3738b527c3----------------------" class="cg ch au av aw ax ay az ba bb ci cj be ck cl" rel="noopener"><svg width="25" height="25" viewBox="0 0 25 25" class="cq r g"><path d="M16 6a2 2 0 0 1 2 2v13.66h-.01a.5.5 0 0 1-.12.29.5.5 0 0 1-.7.03l-5.67-4.13-5.66 4.13a.5.5 0 0 1-.7-.03.48.48 0 0 1-.13-.29H5V8c0-1.1.9-2 2-2h9zM6 8v12.64l5.16-3.67a.49.49 0 0 1 .68 0L17 20.64V8a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1z"></path><path d="M21 5v13.66h-.01a.5.5 0 0 1-.12.29.5.5 0 0 1-.7.03l-.17-.12V5a1 1 0 0 0-1-1h-9a1 1 0 0 0-1 1H8c0-1.1.9-2 2-2h9a2 2 0 0 1 2 2z"></path></svg></a><div class="cq n co"><div class="bx" aria-hidden="true"><button class="cg ch au av aw ax ay az ba bb ci cj be ck cl r"><svg width="25" height="25" viewBox="-293 409 25 25" class="cr r"><path d="M-273.33 423.67l-1.67-1.52v-3.65a5.5 5.5 0 0 0-6.04-5.47 5.66 5.66 0 0 0-4.96 5.71v3.41l-1.68 1.55a1 1 0 0 0-.32.74V427a1 1 0 0 0 1 1h3.49a3.08 3.08 0 0 0 3.01 2.45 3.08 3.08 0 0 0 3.01-2.45h3.49a1 1 0 0 0 1-1v-2.59a1 1 0 0 0-.33-.74zm-7.17 5.63c-.84 0-1.55-.55-1.81-1.3h3.62a1.92 1.92 0 0 1-1.81 1.3zm6.35-2.45h-12.7v-2.35l1.63-1.5c.24-.22.37-.53.37-.85v-3.41a4.51 4.51 0 0 1 3.92-4.57 4.35 4.35 0 0 1 4.78 4.33v3.65c0 .32.14.63.38.85l1.62 1.48v2.37z"></path></svg></button></div></div><div class="kc" id="li-post-page-navbar-upsell-button"><div class="cq r g"><div><a href="https://medium.com/membership?source=upgrade_membership---nav_full------------------------" class="cs ct q cu cv cw cx cy bb ck cz da db dc dd de df bi b bj bk bl bm dg dh di bx dj" rel="noopener">Upgrade</a></div></div></div><div class="n" aria-hidden="true"><div class="dk dl n o"><button class="cg ch au av aw ax ay az ba bb ci cj be ck cl"><img alt="Kiryl" class="r dm dn do" src="./Quantile regression, from linear models to trees to deep learning_files/0_F7rq1F1Sl0nzHJKe.jpg" width="32" height="32"></button></div></div></div></span></div></div></div></div></div><div class="dp r dq ar"><div class="n p"><div class="z ab ac ae af ag ah ai"><div class="dr bv n o"><div class="ds r bh"><a href="https://towardsdatascience.com/?source=post_page-----af3738b527c3----------------------" rel="noopener"><div class="dt du r"><img alt="Towards Data Science" class="" src="./Quantile regression, from linear models to trees to deep learning_files/1_mG6i4Bh_LgixUYXJgQpYsg@2x.png" width="100" height="36"></div></a></div><div class="dv r dw"><ul class="dx ba dy bw dz n ea g eb ec ed"><li class="n o ee ef eg eh"><span class="bi ek el bk em en eo"><a href="https://towardsdatascience.com/data-science/home?source=post_page-----af3738b527c3----------------------" class="cg ch au av aw ax ay az ba bb ep eq be er es" rel="noopener">Data Science</a></span></li><li class="n o ee ef eg eh"><span class="bi ek el bk em en eo"><a href="https://towardsdatascience.com/machine-learning/home?source=post_page-----af3738b527c3----------------------" class="cg ch au av aw ax ay az ba bb ep eq be er es" rel="noopener">Machine Learning</a></span></li><li class="n o ee ef eg eh"><span class="bi ek el bk em en eo"><a href="https://towardsdatascience.com/programming/home?source=post_page-----af3738b527c3----------------------" class="cg ch au av aw ax ay az ba bb ep eq be er es" rel="noopener">Programming</a></span></li><li class="n o ee ef eg eh"><span class="bi ek el bk em en eo"><a href="https://towardsdatascience.com/data-visualization/home?source=post_page-----af3738b527c3----------------------" class="cg ch au av aw ax ay az ba bb ep eq be er es" rel="noopener">Visualization</a></span></li><li class="n o ee ef eg eh"><span class="bi ek el bk em en eo"><a href="https://towardsdatascience.com/artificial-intelligence/home?source=post_page-----af3738b527c3----------------------" class="cg ch au av aw ax ay az ba bb ep eq be er es" rel="noopener">AI</a></span></li><li class="n o ee ef eg eh"><span class="bi ek el bk em en eo"><a href="https://towardsdatascience.com/video/home?source=post_page-----af3738b527c3----------------------" class="cg ch au av aw ax ay az ba bb ep eq be er es" rel="noopener">Video</a></span></li><li class="n o ee ef eg eh"><span class="bi ek el bk em en eo"><a href="https://towardsdatascience.com/about-us/home?source=post_page-----af3738b527c3----------------------" class="cg ch au av aw ax ay az ba bb ep eq be er es" rel="noopener">About</a></span></li><span class="ee ei ej"></span><li class="n o ee ef eg eh"><span class="bi ek el bk em en eo"><a href="https://towardsdatascience.com/contribute/home?source=post_page-----af3738b527c3----------------------" class="cg ch au av aw ax ay az ba bb ep eq be er es" rel="noopener">Contribute</a></span></li></ul></div></div></div></div></div></div></nav><div class="et eu r ev ew"></div><article><section class="ex ey ez fa ai fb di r"></section><span class="r"></span><div><div class="s u fc fd fe ff"></div><div class="ez fa fb cd"><div class="r h g f e"><aside class="sb s t" style="width: 252.333px;"><div class="se sf s sj bw ai"><h4 class="bi ek el bk bn"><span class="bx sf bw bv bu">Top highlight</span></h4></div></aside></div></div><section class="fg fh fi fj fk"><div class="n p"><div class="z ab ac ae af fl ah ai"><div><div id="793b" class="fm fn ct bj fo b fp fq fr fs ft fu fv fw fx fy fz"><h1 class="fo b fp ga fr gb ft gc fv gd fx ge ct">Quantile regression, from linear models to trees to deep learning</h1></div><div class="gf"><div class="n gg gh gi gj"><div class="o n"><div><a href="https://towardsdatascience.com/@MaxGhenis?source=post_page-----af3738b527c3----------------------" rel="noopener"><div class="cd gk gl"><div class="gm n gn o p s go gp gq gr gs ff"><svg width="57" height="57" viewBox="0 0 57 57"><path fill-rule="evenodd" clip-rule="evenodd" d="M28.5 1.2A27.45 27.45 0 0 0 4.06 15.82L3 15.27A28.65 28.65 0 0 1 28.5 0C39.64 0 49.29 6.2 54 15.27l-1.06.55A27.45 27.45 0 0 0 28.5 1.2zM4.06 41.18A27.45 27.45 0 0 0 28.5 55.8a27.45 27.45 0 0 0 24.44-14.62l1.06.55A28.65 28.65 0 0 1 28.5 57 28.65 28.65 0 0 1 3 41.73l1.06-.55z"></path></svg></div><img alt="Max Ghenis" class="r dm gl gk" src="./Quantile regression, from linear models to trees to deep learning_files/2_7R9HC-rx2qMYDvc5HGIQEQ.jpeg" width="48" height="48"></div></a></div><div class="gt ai r"><div class="n"><div style="flex:1"><span class="bi b bj bk bl bm r ct q"><div class="gu n o gv"><span class="bi ek cb bk bv gw bu gx gy gz ct"><a href="https://towardsdatascience.com/@MaxGhenis?source=post_page-----af3738b527c3----------------------" class="cg ch au av aw ax ay az ba bb ha be ck cl" rel="noopener">Max Ghenis</a></span><div class="hb r bh h"><button class="hc cu as at hd bc bd he bb df bi b bj hf el bm dg dh di bx dj">Follow</button></div></div></span></div></div><span class="bi b bj bk bl bm r bn bo"><span class="bi ek cb bk bv gw bu gx gy gz bn"><div><a class="cg ch au av aw ax ay az ba bb ha be ck cl" rel="noopener" href="https://towardsdatascience.com/quantile-regression-from-linear-models-to-trees-to-deep-learning-af3738b527c3?source=post_page-----af3738b527c3----------------------">Oct 17, 2018</a> <!-- -->·<!-- --> <!-- -->8<!-- --> min read</div></span></span></div></div><div class="n hg hh hi hj hk hl hm hn y"><div class="n o"><div class="ho r bh"><button class="cg ch au av aw ax ay az ba bb ci cj be ck cl"><svg width="29" height="29" class="q"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></button></div><div class="ho r bh"><button class="cg ch au av aw ax ay az ba bb ci cj be ck cl"><svg width="29" height="29" viewBox="0 0 29 29" fill="none" class="q"><path d="M5 6.36C5 5.61 5.63 5 6.4 5h16.2c.77 0 1.4.61 1.4 1.36v16.28c0 .75-.63 1.36-1.4 1.36H6.4c-.77 0-1.4-.6-1.4-1.36V6.36z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M10.76 20.9v-8.57H7.89v8.58h2.87zm-1.44-9.75c1 0 1.63-.65 1.63-1.48-.02-.84-.62-1.48-1.6-1.48-.99 0-1.63.64-1.63 1.48 0 .83.62 1.48 1.59 1.48h.01zM12.35 20.9h2.87v-4.79c0-.25.02-.5.1-.7.2-.5.67-1.04 1.46-1.04 1.04 0 1.46.8 1.46 1.95v4.59h2.87v-4.92c0-2.64-1.42-3.87-3.3-3.87-1.55 0-2.23.86-2.61 1.45h.02v-1.24h-2.87c.04.8 0 8.58 0 8.58z" fill="#fff"></path></svg></button></div><div class="ho r bh"><button class="cg ch au av aw ax ay az ba bb ci cj be ck cl"><svg width="29" height="29" class="q"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></button></div><div class="hp r"><div><div class="hq"><div><div class="bx" role="tooltip" aria-hidden="true" aria-describedby="1" aria-labelledby="1"><button class="cg ch au av aw ax ay az ba bb ci cj be ck cl"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div><div class="hr r am"><div class="bx" aria-hidden="true"><div class="bx" aria-hidden="true"><div class="r bh"><button class="cg ch au av aw ax ay az ba bb ci cj be ck cl"><svg width="25" height="25" viewBox="-480.5 272.5 21 21" class="q"><path d="M-463 284.6c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5z"></path></svg></button></div></div></div></div></div></div></div></div></div><p id="a419" class="hs ig ct bj hu b hv hw ih hx hy ii hz ia ij ib ic ik id ie il if fg" data-selectable-paragraph="">Suppose a real estate analyst wants to predict home prices from factors like home age and distance from job centers. The typical goal will be generating the best home price <em class="im">point estimate</em> given those factors, where “best” often refers to the estimate that minimizes squared deviations from reality.</p><p id="1c94" class="hs ig ct bj hu b hv hw ih hx hy ii hz ia ij ib ic ik id ie il if fg" data-selectable-paragraph="">But what if they want to predict not just a single estimate, but also the likely range? This is called the <em class="im">prediction interval</em>, and the general method for producing them is known as <em class="im">quantile regression</em>. In this post I’ll describe how this problem is formalized; how to implement it in six linear, tree-based, and deep learning methods (in Python — <a href="https://colab.research.google.com/drive/1nXOlrmVHqCHiixqiMF6H8LSciz583_W2" class="cg dj in io ip iq" target="_blank" rel="noopener nofollow">here’s the Jupyter notebook</a>); and how they perform against real-world datasets.</p><h1 id="c076" class="ir is ct bj bi it fp iu fr iv iw ix iy iz ja jb jc" data-selectable-paragraph="">Quantile regression minimizes quantile loss</h1><p id="4276" class="hs ig ct bj hu b hv jd ih hx je ii hz jf ij ib jg ik id jh il if fg" data-selectable-paragraph="">Just as regressions minimize the squared-error loss function to predict a single point estimate, quantile regressions minimize the <em class="im">quantile loss </em>in predicting a certain quantile. The most popular quantile is the median, or the 50th percentile, and in this case the quantile loss is simply the sum of <em class="im">absolute</em> errors. Other quantiles could give endpoints of a prediction interval; for example a middle-80-percent range is defined by the 10th and 90th percentiles. <mark class="sc sd mv">The quantile loss differs depending on the evaluated quantile, such that more negative errors are penalized more for higher quantiles and more positive errors are penalized more for lower quantiles.</mark></p><p id="4ad2" class="hs ig ct bj hu b hv hw ih hx hy ii hz ia ij ib ic ik id ie il if fg" data-selectable-paragraph="">Before digging into the formula, suppose we’ve made a prediction for a single point with a true value of zero, and our predictions range from -1 to +1; that is, our errors also range from -1 to +1. This graph shows how the quantile loss varies with the error, depending on the quantile.</p><figure class="jj jk jl jm jn jo ez fa paragraph-image"><div class="jp jq cd jr ai"><div class="ez fa ji"><div class="jw r cd jx"><div class="jy jz r"><div class="cc js s t u jt ai bv ju jv"><img class="s t u jt ai ka kb ao sh" src="./Quantile regression, from linear models to trees to deep learning_files/0_ufWnnvTA9AkjKrfI" width="1131" height="894" role="presentation"></div><img class="qc sa s t u jt ai kd" width="1131" height="894" srcset="https://miro.medium.com/max/552/0*ufWnnvTA9AkjKrfI 276w, https://miro.medium.com/max/1104/0*ufWnnvTA9AkjKrfI 552w, https://miro.medium.com/max/1280/0*ufWnnvTA9AkjKrfI 640w, https://miro.medium.com/max/1400/0*ufWnnvTA9AkjKrfI 700w" sizes="700px" role="presentation" src="./Quantile regression, from linear models to trees to deep learning_files/0_ufWnnvTA9AkjKrfI(1)"><noscript><img class="s t u jt ai" src="https://miro.medium.com/max/2262/0*ufWnnvTA9AkjKrfI" width="1131" height="894" srcSet="https://miro.medium.com/max/552/0*ufWnnvTA9AkjKrfI 276w, https://miro.medium.com/max/1104/0*ufWnnvTA9AkjKrfI 552w, https://miro.medium.com/max/1280/0*ufWnnvTA9AkjKrfI 640w, https://miro.medium.com/max/1400/0*ufWnnvTA9AkjKrfI 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="1550" class="hs ig ct bj hu b hv hw ih hx hy ii hz ia ij ib ic ik id ie il if fg" data-selectable-paragraph="">Let’s look at each line separately:</p><ul class=""><li id="1565" class="hs ig ct bj hu b hv hw ih hx hy ii hz ia ij ib ic ik id ie il if ke kf kg" data-selectable-paragraph=""><strong class="hu kh">The medium blue line shows the median</strong>, which is symmetric around zero, where all losses equal zero because the prediction was perfect. Looks good so far: the median aims to bisect the set of predictions, so we want to weigh underestimates equally to overestimates. As we’ll see soon, the quantile loss around the median is half the absolute deviation, so 0.5 at both -1 and +1, and 0 at 0.</li><li id="12af" class="hs ig ct bj hu b hv ki ih hx kj ii hz kk ij ib kl ik id km il if ke kf kg" data-selectable-paragraph=""><strong class="hu kh">The light blue line shows the 10th percentile</strong>, which assigns a lower loss to negative errors and a higher loss to positive errors. The 10th percentile means we think there’s a 10 percent chance that the true value is below that predicted value, so it makes sense to assign less of a loss to underestimates than to overestimates.</li><li id="953b" class="hs ig ct bj hu b hv ki ih hx kj ii hz kk ij ib kl ik id km il if ke kf kg" data-selectable-paragraph=""><strong class="hu kh">The dark blue line shows the 90th percentile, </strong>which is the reverse pattern from the 10th percentile.</li></ul><p id="1913" class="hs ig ct bj hu b hv hw ih hx hy ii hz ia ij ib ic ik id ie il if fg" data-selectable-paragraph="">We can also look at this by quantile for under- and over-estimated predictions. The higher the quantile, the more the quantile loss function penalizes underestimates and the less it penalizes overestimates.</p><figure class="jj jk jl jm jn jo ez fa paragraph-image"><div class="jp jq cd jr ai"><div class="ez fa ji"><div class="jw r cd jx"><div class="jy jz r"><div class="cc js s t u jt ai bv ju jv"><img class="s t u jt ai ka kb ao sh" src="./Quantile regression, from linear models to trees to deep learning_files/0_La2_sFKLXl6Rw16w" width="1131" height="894" role="presentation"></div><img class="qc sa s t u jt ai kd" width="1131" height="894" srcset="https://miro.medium.com/max/552/0*La2_sFKLXl6Rw16w 276w, https://miro.medium.com/max/1104/0*La2_sFKLXl6Rw16w 552w, https://miro.medium.com/max/1280/0*La2_sFKLXl6Rw16w 640w, https://miro.medium.com/max/1400/0*La2_sFKLXl6Rw16w 700w" sizes="700px" role="presentation" src="./Quantile regression, from linear models to trees to deep learning_files/0_La2_sFKLXl6Rw16w(1)"><noscript><img class="s t u jt ai" src="https://miro.medium.com/max/2262/0*La2_sFKLXl6Rw16w" width="1131" height="894" srcSet="https://miro.medium.com/max/552/0*La2_sFKLXl6Rw16w 276w, https://miro.medium.com/max/1104/0*La2_sFKLXl6Rw16w 552w, https://miro.medium.com/max/1280/0*La2_sFKLXl6Rw16w 640w, https://miro.medium.com/max/1400/0*La2_sFKLXl6Rw16w 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="987c" class="hs ig ct bj hu b hv hw ih hx hy ii hz ia ij ib ic ik id ie il if fg" data-selectable-paragraph="">Given this intuition, here’s the quantile loss formula (<a class="cg dj in io ip iq" target="_blank" rel="noopener" href="https://towardsdatascience.com/deep-quantile-regression-c85481548b5a">source</a>):</p><figure class="jj jk jl jm jn jo ez fa paragraph-image"><div class="ez fa kn"><div class="jw r cd jx"><div class="ko jz r"><div class="cc js s t u jt ai bv ju jv"><img class="s t u jt ai ka kb ao sh" src="./Quantile regression, from linear models to trees to deep learning_files/0_sBQtWnFYbxUErMfD" width="284" height="57" role="presentation"></div><img class="qc sa s t u jt ai kd" width="284" height="57" srcset="https://miro.medium.com/max/552/0*sBQtWnFYbxUErMfD 276w, https://miro.medium.com/max/568/0*sBQtWnFYbxUErMfD 284w" sizes="284px" role="presentation" src="./Quantile regression, from linear models to trees to deep learning_files/0_sBQtWnFYbxUErMfD(1)"><noscript><img class="s t u jt ai" src="https://miro.medium.com/max/568/0*sBQtWnFYbxUErMfD" width="284" height="57" srcSet="https://miro.medium.com/max/552/0*sBQtWnFYbxUErMfD 276w, https://miro.medium.com/max/568/0*sBQtWnFYbxUErMfD 284w" sizes="284px" role="presentation"/></noscript></div></div></div></figure><p id="45ca" class="hs ig ct bj hu b hv hw ih hx hy ii hz ia ij ib ic ik id ie il if fg" data-selectable-paragraph="">And in Python code, where we can replace the branched logic with a <code class="jx kp kq kr ks b">maximum</code> statement:</p><pre class="jj jk jl jm jn kt ku dz"><span id="855a" class="kv is ct bj ks b cb kw kx r ky" data-selectable-paragraph="">def quantile_loss(q, y, f):<br>  # q: Quantile to be evaluated, e.g., 0.5 for median.<br>  # y: True value.<br>  # f: Fitted (predicted) value.<br>  e = y - f<br>  return np.maximum(q * e, (q - 1) * e)</span></pre><p id="d523" class="hs ig ct bj hu b hv hw ih hx hy ii hz ia ij ib ic ik id ie il if fg" data-selectable-paragraph="">Next we’ll look at the six methods — OLS, linear quantile regression, random forests, gradient boosting, Keras, and TensorFlow — and see how they work with some real data.</p><h1 id="e45d" class="ir is ct bj bi it fp iu fr iv iw ix iy iz ja jb jc" data-selectable-paragraph="">The data</h1><p id="095a" class="hs ig ct bj hu b hv jd ih hx je ii hz jf ij ib jg ik id jh il if fg" data-selectable-paragraph="">This analysis will use the <a href="https://www.kaggle.com/c/boston-housing" class="cg dj in io ip iq" target="_blank" rel="noopener nofollow">Boston housing dataset</a>, which contains 506 observations representing towns in the Boston area. It includes 13 features alongside the target, the median value of owner-occupied homes. Quantile regression therefore is predicting the share of towns (not homes) with median home values below a value.</p><p id="d85a" class="hs ig ct bj hu b hv hw ih hx hy ii hz ia ij ib ic ik id ie il if fg" data-selectable-paragraph="">I train the models on 80 percent and test on the remaining 20 percent. For easier visualization, the first set of models uses a single feature: <code class="jx kp kq kr ks b">AGE</code>, the proportion of owner-occupied units built prior to 1940. As we might expect, towns with older homes have lower home values, though the relationship is noisy.</p><figure class="jj jk jl jm jn jo ez fa paragraph-image"><div class="jp jq cd jr ai"><div class="ez fa kz"><div class="jw r cd jx"><div class="la jz r"><div class="cc js s t u jt ai bv ju jv"><img class="s t u jt ai ka kb ao sh" src="./Quantile regression, from linear models to trees to deep learning_files/0_iWF8FCQyC_Nh2RQ3" width="1153" height="895" role="presentation"></div><img class="qc sa s t u jt ai kd" width="1153" height="895" srcset="https://miro.medium.com/max/552/0*iWF8FCQyC_Nh2RQ3 276w, https://miro.medium.com/max/1104/0*iWF8FCQyC_Nh2RQ3 552w, https://miro.medium.com/max/1280/0*iWF8FCQyC_Nh2RQ3 640w, https://miro.medium.com/max/1400/0*iWF8FCQyC_Nh2RQ3 700w" sizes="700px" role="presentation" src="./Quantile regression, from linear models to trees to deep learning_files/0_iWF8FCQyC_Nh2RQ3(1)"><noscript><img class="s t u jt ai" src="https://miro.medium.com/max/2306/0*iWF8FCQyC_Nh2RQ3" width="1153" height="895" srcSet="https://miro.medium.com/max/552/0*iWF8FCQyC_Nh2RQ3 276w, https://miro.medium.com/max/1104/0*iWF8FCQyC_Nh2RQ3 552w, https://miro.medium.com/max/1280/0*iWF8FCQyC_Nh2RQ3 640w, https://miro.medium.com/max/1400/0*iWF8FCQyC_Nh2RQ3 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="a295" class="hs ig ct bj hu b hv hw ih hx hy ii hz ia ij ib ic ik id ie il if fg" data-selectable-paragraph="">For each method, we’ll predict the 10th, 30th, 50th, 70th, and 90th percentiles on the test set.</p><h1 id="9bfa" class="ir is ct bj bi it fp iu fr iv iw ix iy iz ja jb jc" data-selectable-paragraph="">Ordinary least squares</h1><p id="d650" class="hs ig ct bj hu b hv jd ih hx je ii hz jf ij ib jg ik id jh il if fg" data-selectable-paragraph="">Although OLS predicts the mean rather than the median, we can still calculate prediction intervals from it based on standard errors and the inverse normal CDF:</p><pre class="jj jk jl jm jn kt ku dz"><span id="62fa" class="kv is ct bj ks b cb kw kx r ky" data-selectable-paragraph="">def ols_quantile(m, X, q):<br>  # m: OLS statsmodels model.<br>  # X: X matrix.<br>  # q: Quantile.<br>  mean_pred = m.predict(X)<br>  se = np.sqrt(m.scale)<br>  return mean_pred + norm.ppf(q) * se</span></pre><p id="d635" class="hs ig ct bj hu b hv hw ih hx hy ii hz ia ij ib ic ik id ie il if fg" data-selectable-paragraph="">This baseline approach produces linear and parallel quantiles centered around the mean (which is predicted as the median). A well-tuned model will show about 80 percent of dots in between the top and bottom lines. Note the dots differ from the first scatter plot, as here we’re showing the test set to evaluate out-of-sample predictions.</p><figure class="jj jk jl jm jn jo ez fa paragraph-image"><div class="jp jq cd jr ai"><div class="ez fa lb"><div class="jw r cd jx"><div class="lc jz r"><div class="qc sa s t u jt ai bv ju jv"><img class="s t u jt ai ka kb kc" src="./Quantile regression, from linear models to trees to deep learning_files/0_swvEEDGS68RR0fUb" width="1187" height="894" role="presentation"></div><img class="cc js s t u jt ai kd" width="1187" height="894" srcset="https://miro.medium.com/max/552/0*swvEEDGS68RR0fUb 276w, https://miro.medium.com/max/1104/0*swvEEDGS68RR0fUb 552w, https://miro.medium.com/max/1280/0*swvEEDGS68RR0fUb 640w, https://miro.medium.com/max/1400/0*swvEEDGS68RR0fUb 700w" sizes="700px" role="presentation"><noscript><img class="s t u jt ai" src="https://miro.medium.com/max/2374/0*swvEEDGS68RR0fUb" width="1187" height="894" srcSet="https://miro.medium.com/max/552/0*swvEEDGS68RR0fUb 276w, https://miro.medium.com/max/1104/0*swvEEDGS68RR0fUb 552w, https://miro.medium.com/max/1280/0*swvEEDGS68RR0fUb 640w, https://miro.medium.com/max/1400/0*swvEEDGS68RR0fUb 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><h1 id="be97" class="ir is ct bj bi it fp iu fr iv iw ix iy iz ja jb jc" data-selectable-paragraph="">Linear quantile regression</h1><p id="bf8b" class="hs ig ct bj hu b hv jd ih hx je ii hz jf ij ib jg ik id jh il if fg" data-selectable-paragraph="">Linear models extend beyond the mean to the median and other quantiles. Linear quantile regression predicts a given quantile, relaxing OLS’s parallel trend assumption while still imposing linearity (under the hood, it’s minimizing quantile loss). This is straightforward with <code class="jx kp kq kr ks b">statsmodels</code> :</p><pre class="jj jk jl jm jn kt ku dz"><span id="2383" class="kv is ct bj ks b cb kw kx r ky" data-selectable-paragraph="">sm.QuantReg(train_labels, X_train).fit(q=q).predict(X_test)<br># Provide q.</span></pre><figure class="jj jk jl jm jn jo ez fa paragraph-image"><div class="jp jq cd jr ai"><div class="ez fa lb"><div class="jw r cd jx"><div class="lc jz r"><div class="qc sa s t u jt ai bv ju jv"><img class="s t u jt ai ka kb kc" src="./Quantile regression, from linear models to trees to deep learning_files/0_fzc8JnVklM7Gj_Kn" width="1187" height="894" role="presentation"></div><img class="cc js s t u jt ai kd" width="1187" height="894" srcset="https://miro.medium.com/max/552/0*fzc8JnVklM7Gj_Kn 276w, https://miro.medium.com/max/1104/0*fzc8JnVklM7Gj_Kn 552w, https://miro.medium.com/max/1280/0*fzc8JnVklM7Gj_Kn 640w, https://miro.medium.com/max/1400/0*fzc8JnVklM7Gj_Kn 700w" sizes="700px" role="presentation"><noscript><img class="s t u jt ai" src="https://miro.medium.com/max/2374/0*fzc8JnVklM7Gj_Kn" width="1187" height="894" srcSet="https://miro.medium.com/max/552/0*fzc8JnVklM7Gj_Kn 276w, https://miro.medium.com/max/1104/0*fzc8JnVklM7Gj_Kn 552w, https://miro.medium.com/max/1280/0*fzc8JnVklM7Gj_Kn 640w, https://miro.medium.com/max/1400/0*fzc8JnVklM7Gj_Kn 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><h1 id="3b08" class="ir is ct bj bi it fp iu fr iv iw ix iy iz ja jb jc" data-selectable-paragraph="">Random forests</h1><p id="534a" class="hs ig ct bj hu b hv jd ih hx je ii hz jf ij ib jg ik id jh il if fg" data-selectable-paragraph="">Our first departure from linear models is <a href="https://en.wikipedia.org/wiki/Random_forest" class="cg dj in io ip iq" target="_blank" rel="noopener nofollow">random forests</a>, a collection of trees. While this model doesn’t explicitly predict quantiles, we can treat each tree as a possible value, and calculate quantiles using its <a href="https://en.wikipedia.org/wiki/Empirical_distribution_function" class="cg dj in io ip iq" target="_blank" rel="noopener nofollow">empirical CDF</a> (<a href="https://blog.datadive.net/prediction-intervals-for-random-forests/" class="cg dj in io ip iq" target="_blank" rel="noopener nofollow">Ando Saabas has written more on this</a>):</p><pre class="jj jk jl jm jn kt ku dz"><span id="4d01" class="kv is ct bj ks b cb kw kx r ky" data-selectable-paragraph="">def rf_quantile(m, X, q):<br>  # m: sklearn random forests model.<br>  # X: X matrix.<br>  # q: Quantile.<br>  rf_preds = []<br>  for estimator in m.estimators_:<br>    rf_preds.append(estimator.predict(X))<br>  # One row per record.<br>  rf_preds = np.array(rf_preds).transpose()<br>  return np.percentile(rf_preds, q * 100, axis=1)</span></pre><p id="9e76" class="hs ig ct bj hu b hv hw ih hx hy ii hz ia ij ib ic ik id ie il if fg" data-selectable-paragraph="">It goes a bit crazy in this case, suggesting overfitting. Since random forests are more commonly used for high-dimensional datasets, we’ll return to them after adding more features to the model.</p><figure class="jj jk jl jm jn jo ez fa paragraph-image"><div class="jp jq cd jr ai"><div class="ez fa lb"><div class="jw r cd jx"><div class="lc jz r"><div class="qc sa s t u jt ai bv ju jv"><img class="s t u jt ai ka kb kc" src="./Quantile regression, from linear models to trees to deep learning_files/0_9ez_bYKF7SrVOPkK" width="1187" height="894" role="presentation"></div><img class="cc js s t u jt ai kd" width="1187" height="894" srcset="https://miro.medium.com/max/552/0*9ez_bYKF7SrVOPkK 276w, https://miro.medium.com/max/1104/0*9ez_bYKF7SrVOPkK 552w, https://miro.medium.com/max/1280/0*9ez_bYKF7SrVOPkK 640w, https://miro.medium.com/max/1400/0*9ez_bYKF7SrVOPkK 700w" sizes="700px" role="presentation"><noscript><img class="s t u jt ai" src="https://miro.medium.com/max/2374/0*9ez_bYKF7SrVOPkK" width="1187" height="894" srcSet="https://miro.medium.com/max/552/0*9ez_bYKF7SrVOPkK 276w, https://miro.medium.com/max/1104/0*9ez_bYKF7SrVOPkK 552w, https://miro.medium.com/max/1280/0*9ez_bYKF7SrVOPkK 640w, https://miro.medium.com/max/1400/0*9ez_bYKF7SrVOPkK 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><h1 id="0557" class="ir is ct bj bi it fp iu fr iv iw ix iy iz ja jb jc" data-selectable-paragraph="">Gradient boosting</h1><p id="1df5" class="hs ig ct bj hu b hv jd ih hx je ii hz jf ij ib jg ik id jh il if fg" data-selectable-paragraph="">Another tree-based method is <a href="https://en.wikipedia.org/wiki/Gradient_boosting" class="cg dj in io ip iq" target="_blank" rel="noopener nofollow">gradient boosting</a>, <code class="jx kp kq kr ks b">scikit-learn</code>’s <a href="http://scikit-learn.org/stable/modules/generated/sklearn.ensemble.GradientBoostingRegressor.html" class="cg dj in io ip iq" target="_blank" rel="noopener nofollow">implementation of which</a> supports explicit quantile prediction:</p><pre class="jj jk jl jm jn kt ku dz"><span id="c8ae" class="kv is ct bj ks b cb kw kx r ky" data-selectable-paragraph="">ensemble.GradientBoostingRegressor(loss='quantile', alpha=q)</span></pre><p id="7f77" class="hs ig ct bj hu b hv hw ih hx hy ii hz ia ij ib ic ik id ie il if fg" data-selectable-paragraph="">While not as jumpy as the random forests, it doesn’t look to do great on the one-feature model either.</p><figure class="jj jk jl jm jn jo ez fa paragraph-image"><div class="jp jq cd jr ai"><div class="ez fa lb"><div class="jw r cd jx"><div class="lc jz r"><div class="qc sa s t u jt ai bv ju jv"><img class="s t u jt ai ka kb kc" src="./Quantile regression, from linear models to trees to deep learning_files/0_n64W1bkgIYZn-r7W" width="1187" height="894" role="presentation"></div><img class="cc js s t u jt ai kd" width="1187" height="894" srcset="https://miro.medium.com/max/552/0*n64W1bkgIYZn-r7W 276w, https://miro.medium.com/max/1104/0*n64W1bkgIYZn-r7W 552w, https://miro.medium.com/max/1280/0*n64W1bkgIYZn-r7W 640w, https://miro.medium.com/max/1400/0*n64W1bkgIYZn-r7W 700w" sizes="700px" role="presentation"><noscript><img class="s t u jt ai" src="https://miro.medium.com/max/2374/0*n64W1bkgIYZn-r7W" width="1187" height="894" srcSet="https://miro.medium.com/max/552/0*n64W1bkgIYZn-r7W 276w, https://miro.medium.com/max/1104/0*n64W1bkgIYZn-r7W 552w, https://miro.medium.com/max/1280/0*n64W1bkgIYZn-r7W 640w, https://miro.medium.com/max/1400/0*n64W1bkgIYZn-r7W 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><h1 id="e335" class="ir is ct bj bi it fp iu fr iv iw ix iy iz ja jb jc" data-selectable-paragraph="">Keras (deep learning)</h1><p id="a4d0" class="hs ig ct bj hu b hv jd ih hx je ii hz jf ij ib jg ik id jh il if fg" data-selectable-paragraph=""><a href="https://keras.io/" class="cg dj in io ip iq" target="_blank" rel="noopener nofollow">Keras</a> is a user-friendly wrapper for neural network toolkits including <a href="http://tensorflow.org/" class="cg dj in io ip iq" target="_blank" rel="noopener nofollow">TensorFlow</a>. We can use deep neural networks to predict quantiles by passing the quantile loss function. The code is somewhat involved, so check out the <a href="https://colab.research.google.com/drive/1nXOlrmVHqCHiixqiMF6H8LSciz583_W2#scrollTo=g7s7Grj-A-Sf" class="cg dj in io ip iq" target="_blank" rel="noopener nofollow">Jupyter notebook</a> or <a class="cg dj in io ip iq" target="_blank" rel="noopener" href="https://towardsdatascience.com/deep-quantile-regression-c85481548b5a">read more from</a> <a href="https://medium.com/u/4d883eeaf62d?source=post_page-----af3738b527c3----------------------" class="ld as dj" target="_blank" rel="noopener">Sachin Abeywardana</a> to see how it works.</p><p id="6e58" class="hs ig ct bj hu b hv hw ih hx hy ii hz ia ij ib ic ik id ie il if fg" data-selectable-paragraph="">Underlying most deep nets are linear models with kinks (called <em class="im">rectified linear units</em>, or <em class="im">ReLUs</em>), which we can see here visually: Keras predicts more bunching up of home values for towns with about 70 percent built before 1940, while fanning out more at the very low and very high ends of age. This seems to be a good prediction based on fit of the test data.</p><figure class="jj jk jl jm jn jo ez fa paragraph-image"><div class="jp jq cd jr ai"><div class="ez fa lb"><div class="jw r cd jx"><div class="lc jz r"><div class="qc sa s t u jt ai bv ju jv"><img class="s t u jt ai ka kb kc" src="./Quantile regression, from linear models to trees to deep learning_files/0_BkSIs6ycS59UGzlZ" width="1187" height="894" role="presentation"></div><img class="cc js s t u jt ai kd" width="1187" height="894" srcset="https://miro.medium.com/max/552/0*BkSIs6ycS59UGzlZ 276w, https://miro.medium.com/max/1104/0*BkSIs6ycS59UGzlZ 552w, https://miro.medium.com/max/1280/0*BkSIs6ycS59UGzlZ 640w, https://miro.medium.com/max/1400/0*BkSIs6ycS59UGzlZ 700w" sizes="700px" role="presentation"><noscript><img class="s t u jt ai" src="https://miro.medium.com/max/2374/0*BkSIs6ycS59UGzlZ" width="1187" height="894" srcSet="https://miro.medium.com/max/552/0*BkSIs6ycS59UGzlZ 276w, https://miro.medium.com/max/1104/0*BkSIs6ycS59UGzlZ 552w, https://miro.medium.com/max/1280/0*BkSIs6ycS59UGzlZ 640w, https://miro.medium.com/max/1400/0*BkSIs6ycS59UGzlZ 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><h1 id="2ee9" class="ir is ct bj bi it fp iu fr iv iw ix iy iz ja jb jc" data-selectable-paragraph="">TensorFlow</h1><p id="7658" class="hs ig ct bj hu b hv jd ih hx je ii hz jf ij ib jg ik id jh il if fg" data-selectable-paragraph="">One disadvantage of Keras is that each quantile must be trained separately. To leverage patterns common to the quantiles, we have to go to TensorFlow itself. See the <a href="https://colab.research.google.com/drive/1nXOlrmVHqCHiixqiMF6H8LSciz583_W2#scrollTo=g7s7Grj-A-Sf" class="cg dj in io ip iq" target="_blank" rel="noopener nofollow">Jupyter notebook</a> and <a href="https://medium.com/u/4459aa7bce57?source=post_page-----af3738b527c3----------------------" class="ld as dj" target="_blank" rel="noopener">Jacob Zweig</a>’s <a class="cg dj in io ip iq" target="_blank" rel="noopener" href="https://towardsdatascience.com/deep-quantile-regression-in-tensorflow-1dbc792fe597">article</a> to learn more about this.</p><p id="1a7b" class="hs ig ct bj hu b hv hw ih hx hy ii hz ia ij ib ic ik id ie il if fg" data-selectable-paragraph="">We can see this co-learning across the quantiles in its predictions, where the model learns a common kink rather than separate ones for each quantile. This looks to be a good Occam-inspired choice.</p><figure class="jj jk jl jm jn jo ez fa paragraph-image"><div class="jp jq cd jr ai"><div class="ez fa lb"><div class="jw r cd jx"><div class="lc jz r"><div class="qc sa s t u jt ai bv ju jv"><img class="s t u jt ai ka kb kc" src="./Quantile regression, from linear models to trees to deep learning_files/0_jACva6ArwF4L_Vwt" width="1187" height="894" role="presentation"></div><img class="cc js s t u jt ai kd" width="1187" height="894" srcset="https://miro.medium.com/max/552/0*jACva6ArwF4L_Vwt 276w, https://miro.medium.com/max/1104/0*jACva6ArwF4L_Vwt 552w, https://miro.medium.com/max/1280/0*jACva6ArwF4L_Vwt 640w, https://miro.medium.com/max/1400/0*jACva6ArwF4L_Vwt 700w" sizes="700px" role="presentation"><noscript><img class="s t u jt ai" src="https://miro.medium.com/max/2374/0*jACva6ArwF4L_Vwt" width="1187" height="894" srcSet="https://miro.medium.com/max/552/0*jACva6ArwF4L_Vwt 276w, https://miro.medium.com/max/1104/0*jACva6ArwF4L_Vwt 552w, https://miro.medium.com/max/1280/0*jACva6ArwF4L_Vwt 640w, https://miro.medium.com/max/1400/0*jACva6ArwF4L_Vwt 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><h1 id="f037" class="ir is ct bj bi it fp iu fr iv iw ix iy iz ja jb jc" data-selectable-paragraph="">Which did best?</h1><p id="715d" class="hs ig ct bj hu b hv jd ih hx je ii hz jf ij ib jg ik id jh il if fg" data-selectable-paragraph="">Eyeballing suggests that deep learning did well, linear models did OK, and tree-based methods did poorly, but can we quantify which is best? Yes we can, using quantile loss over the test set.</p><p id="b21b" class="hs ig ct bj hu b hv hw ih hx hy ii hz ia ij ib ic ik id ie il if fg" data-selectable-paragraph="">Recall that the quantile loss differs depending on the quantile. Since we calculated five quantiles, we have five quantile losses for each observation in the test set. Averaging over all quantile-observations confirms the visual intuition: random forests did worst, while TensorFlow did best.</p><figure class="jj jk jl jm jn jo ez fa paragraph-image"><div class="jp jq cd jr ai"><div class="ez fa le"><div class="jw r cd jx"><div class="lf jz r"><div class="qc sa s t u jt ai bv ju jv"><img class="s t u jt ai ka kb kc" src="./Quantile regression, from linear models to trees to deep learning_files/0_TE_SIChhR9fSV9bO" width="1275" height="894" role="presentation"></div><img class="cc js s t u jt ai kd" width="1275" height="894" srcset="https://miro.medium.com/max/552/0*TE_SIChhR9fSV9bO 276w, https://miro.medium.com/max/1104/0*TE_SIChhR9fSV9bO 552w, https://miro.medium.com/max/1280/0*TE_SIChhR9fSV9bO 640w, https://miro.medium.com/max/1400/0*TE_SIChhR9fSV9bO 700w" sizes="700px" role="presentation"><noscript><img class="s t u jt ai" src="https://miro.medium.com/max/2550/0*TE_SIChhR9fSV9bO" width="1275" height="894" srcSet="https://miro.medium.com/max/552/0*TE_SIChhR9fSV9bO 276w, https://miro.medium.com/max/1104/0*TE_SIChhR9fSV9bO 552w, https://miro.medium.com/max/1280/0*TE_SIChhR9fSV9bO 640w, https://miro.medium.com/max/1400/0*TE_SIChhR9fSV9bO 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="a109" class="hs ig ct bj hu b hv hw ih hx hy ii hz ia ij ib ic ik id ie il if fg" data-selectable-paragraph="">We can also break this out by quantile, revealing that tree-based methods did especially poorly at the 90th percentile, while deep learning did best at the lower quantiles.</p><figure class="jj jk jl jm jn jo ez fa paragraph-image"><div class="jp jq cd jr ai"><div class="ez fa ji"><div class="jw r cd jx"><div class="jy jz r"><div class="qc sa s t u jt ai bv ju jv"><img class="s t u jt ai ka kb kc" src="./Quantile regression, from linear models to trees to deep learning_files/0_SmMb_wtpgU2Kxnf2" width="1131" height="894" role="presentation"></div><img class="cc js s t u jt ai kd" width="1131" height="894" srcset="https://miro.medium.com/max/552/0*SmMb_wtpgU2Kxnf2 276w, https://miro.medium.com/max/1104/0*SmMb_wtpgU2Kxnf2 552w, https://miro.medium.com/max/1280/0*SmMb_wtpgU2Kxnf2 640w, https://miro.medium.com/max/1400/0*SmMb_wtpgU2Kxnf2 700w" sizes="700px" role="presentation"><noscript><img class="s t u jt ai" src="https://miro.medium.com/max/2262/0*SmMb_wtpgU2Kxnf2" width="1131" height="894" srcSet="https://miro.medium.com/max/552/0*SmMb_wtpgU2Kxnf2 276w, https://miro.medium.com/max/1104/0*SmMb_wtpgU2Kxnf2 552w, https://miro.medium.com/max/1280/0*SmMb_wtpgU2Kxnf2 640w, https://miro.medium.com/max/1400/0*SmMb_wtpgU2Kxnf2 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><h1 id="181d" class="ir is ct bj bi it fp iu fr iv iw ix iy iz ja jb jc" data-selectable-paragraph="">Larger datasets give more opportunity to improve over OLS</h1><p id="31e6" class="hs ig ct bj hu b hv jd ih hx je ii hz jf ij ib jg ik id jh il if fg" data-selectable-paragraph="">So random forests was awful for this one-feature dataset, but that’s not what they’re made for. What happens if we add the other 12 features to the Boston housing model?</p><figure class="jj jk jl jm jn jo ez fa paragraph-image"><div class="jp jq cd jr ai"><div class="ez fa lg"><div class="jw r cd jx"><div class="lh jz r"><div class="qc sa s t u jt ai bv ju jv"><img class="s t u jt ai ka kb kc" src="./Quantile regression, from linear models to trees to deep learning_files/0_ybjeY9K-tED8hfbD" width="1291" height="894" role="presentation"></div><img class="cc js s t u jt ai kd" width="1291" height="894" srcset="https://miro.medium.com/max/552/0*ybjeY9K-tED8hfbD 276w, https://miro.medium.com/max/1104/0*ybjeY9K-tED8hfbD 552w, https://miro.medium.com/max/1280/0*ybjeY9K-tED8hfbD 640w, https://miro.medium.com/max/1400/0*ybjeY9K-tED8hfbD 700w" sizes="700px" role="presentation"><noscript><img class="s t u jt ai" src="https://miro.medium.com/max/2582/0*ybjeY9K-tED8hfbD" width="1291" height="894" srcSet="https://miro.medium.com/max/552/0*ybjeY9K-tED8hfbD 276w, https://miro.medium.com/max/1104/0*ybjeY9K-tED8hfbD 552w, https://miro.medium.com/max/1280/0*ybjeY9K-tED8hfbD 640w, https://miro.medium.com/max/1400/0*ybjeY9K-tED8hfbD 700w" sizes="700px" role="presentation"/></noscript></div></div></div></div></figure><p id="e2ec" class="hs ig ct bj hu b hv hw ih hx hy ii hz ia ij ib ic ik id ie il if fg" data-selectable-paragraph="">The tree-based methods made a comeback, and while the OLS improved, the gap between OLS and other non-tree methods grew.</p></div></div></section><hr class="li ek lj lk by ll lm ln lo lp lq lr"><section class="fg fh fi fj fk"><div class="n p"><div class="z ab ac ae af fl ah ai"><p id="f1d1" class="hs ig ct bj hu b hv hw ih hx hy ii hz ia ij ib ic ik id ie il if fg" data-selectable-paragraph="">Real-world problems often extend beyond predicting means. Maybe an app developer is interested not only in users’ expected usage, but also their probability of becoming super-users. Or an auto insurance company wants to know the chance of a driver’s high-value claim at different thresholds. Economists might want to stochastically impute information from one dataset onto another, picking from the CDF to ensure proper variation (an example I’ll explore in a follow-up post).</p><p id="4b00" class="hs ig ct bj hu b hv hw ih hx hy ii hz ia ij ib ic ik id ie il if fg" data-selectable-paragraph="">Quantile regression is valuable for each of these use cases, and machine learning tools can often outperform linear models, especially the easy-to-use tree-based methods. Try it out on your own data and let me know how it goes!</p></div></div></section></div></article><div class="qc ff ls lt ai lu lv lw" data-test-id="post-sidebar"><div class="n p"><div class="z ab ac ae af ag ah ai"><div class="mb n mc"><div class="si"><div class="md me r"><a href="https://towardsdatascience.com/?source=post_sidebar--------------------------post_sidebar-" class="cg ch au av aw ax ay az ba bb ci cj be ck cl" rel="noopener"><h2 class="bi it mf bk ct">Towards Data Science</h2></a><div class="mg mh r"><h4 class="bi ek cb bk bv mi bu gx mj gz bn">A Medium publication sharing concepts, ideas, and codes.</h4></div><div class="bx" aria-hidden="true"><button class="cs cu as at hd bc bd he bb df bi b bj bk bl bm dg dh di bx dj">Follow</button></div></div><div class="mk ml mm n"><div class="n o"><div class="r cd mn mo mp mq mr"><div class=""><button class="az ms mt mu mv mw mx my q mz na"><svg width="29" height="29"><g fill-rule="evenodd"><path d="M13.74 1l.76 2.97.76-2.97zM16.82 4.78l1.84-2.56-1.43-.47zM10.38 2.22l1.84 2.56-.41-3.03zM22.38 22.62a5.11 5.11 0 0 1-3.16 1.61l.49-.45c2.88-2.89 3.45-5.98 1.69-9.21l-1.1-1.94-.96-2.02c-.31-.67-.23-1.18.25-1.55a.84.84 0 0 1 .66-.16c.34.05.66.28.88.6l2.85 5.02c1.18 1.97 1.38 5.12-1.6 8.1M9.1 22.1l-5.02-5.02a1 1 0 0 1 .7-1.7 1 1 0 0 1 .72.3l2.6 2.6a.44.44 0 0 0 .63-.62L6.1 15.04l-1.75-1.75a1 1 0 1 1 1.41-1.41l4.15 4.15a.44.44 0 0 0 .63 0 .44.44 0 0 0 0-.62L6.4 11.26l-1.18-1.18a1 1 0 0 1 0-1.4 1.02 1.02 0 0 1 1.41 0l1.18 1.16L11.96 14a.44.44 0 0 0 .62 0 .44.44 0 0 0 0-.63L8.43 9.22a.99.99 0 0 1-.3-.7.99.99 0 0 1 .3-.7 1 1 0 0 1 1.41 0l7 6.98a.44.44 0 0 0 .7-.5l-1.35-2.85c-.31-.68-.23-1.19.25-1.56a.85.85 0 0 1 .66-.16c.34.06.66.28.88.6L20.63 15c1.57 2.88 1.07 5.54-1.55 8.16a5.62 5.62 0 0 1-5.06 1.65 9.35 9.35 0 0 1-4.93-2.72zM13 6.98l2.56 2.56c-.5.6-.56 1.41-.15 2.28l.26.56-4.25-4.25a.98.98 0 0 1-.12-.45 1 1 0 0 1 .29-.7 1.02 1.02 0 0 1 1.41 0zm8.89 2.06c-.38-.56-.9-.92-1.49-1.01a1.74 1.74 0 0 0-1.34.33c-.38.29-.61.65-.71 1.06a2.1 2.1 0 0 0-1.1-.56 1.78 1.78 0 0 0-.99.13l-2.64-2.64a1.88 1.88 0 0 0-2.65 0 1.86 1.86 0 0 0-.48.85 1.89 1.89 0 0 0-2.67-.01 1.87 1.87 0 0 0-.5.9c-.76-.75-2-.75-2.7-.04a1.88 1.88 0 0 0 0 2.66c-.3.12-.61.29-.87.55a1.88 1.88 0 0 0 0 2.66l.62.62a1.88 1.88 0 0 0-.9 3.16l5.01 5.02c1.6 1.6 3.52 2.64 5.4 2.96a7.16 7.16 0 0 0 1.18.1c1.03 0 2-.25 2.9-.7A5.9 5.9 0 0 0 23 23.24c3.34-3.34 3.08-6.93 1.74-9.17l-2.87-5.04z"></path></g></svg></button></div></div><div class="r nb nc nd ne nf ng nh"><div class="ni"><h4 class="bi ek cb bk bn"><button class="cg ch au av aw ax ay az ba bb ci cj be ck cl">440 </button></h4></div></div></div></div><div class="ml r"></div><div><div class="hq"><div><div class="bx" role="tooltip" aria-hidden="true" aria-describedby="2" aria-labelledby="2"><button class="cg ch au av aw ax ay az ba bb ci cj be ck cl"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div></div></div></div></div><div class="qc si ls lt lx gr ly lz lv ma"></div><div><div class="nj jo n mc p"><div class="n p"><div class="z ab ac ae af fl ah ai"><div class="n nk"></div><div class="n o nk"></div><div class="nl r"><ul class="az ba"><li class="bx dx hp nm"><a href="https://towardsdatascience.com/tagged/machine-learning" class="nn no dj bn r ku np a b el">Machine Learning</a></li><li class="bx dx hp nm"><a href="https://towardsdatascience.com/tagged/predictive-analytics" class="nn no dj bn r ku np a b el">Predictive Analytics</a></li><li class="bx dx hp nm"><a href="https://towardsdatascience.com/tagged/deep-learning" class="nn no dj bn r ku np a b el">Deep Learning</a></li><li class="bx dx hp nm"><a href="https://towardsdatascience.com/tagged/regression" class="nn no dj bn r ku np a b el">Regression</a></li><li class="bx dx hp nm"><a href="https://towardsdatascience.com/tagged/tensorflow" class="nn no dj bn r ku np a b el">TensorFlow</a></li></ul></div><div class="nq n gg y"><div class="n gn"><div class="nr r"><div class="n o"><div class="r cd ns nt nu nv nw"><div class=""><div class="c nx dm n o ny cd nz oa ob oc od oe of og oh oi oj ok ol om"><button class="az ms mt mu mv mw on my o kd dm n p oo u jt s t ai q mz na op"><svg width="33" height="33" viewBox="0 0 33 33"><path d="M28.86 17.34l-3.64-6.4c-.3-.43-.71-.73-1.16-.8a1.12 1.12 0 0 0-.9.21c-.62.5-.73 1.18-.32 2.06l1.22 2.6 1.4 2.45c2.23 4.09 1.51 8-2.15 11.66a9.6 9.6 0 0 1-.8.71 6.53 6.53 0 0 0 4.3-2.1c3.82-3.82 3.57-7.87 2.05-10.39zm-6.25 11.08c3.35-3.35 4-6.78 1.98-10.47L21.2 12c-.3-.43-.71-.72-1.16-.8a1.12 1.12 0 0 0-.9.22c-.62.49-.74 1.18-.32 2.06l1.72 3.63a.5.5 0 0 1-.81.57l-8.91-8.9a1.33 1.33 0 0 0-1.89 1.88l5.3 5.3a.5.5 0 0 1-.71.7l-5.3-5.3-1.49-1.49c-.5-.5-1.38-.5-1.88 0a1.34 1.34 0 0 0 0 1.89l1.49 1.5 5.3 5.28a.5.5 0 0 1-.36.86.5.5 0 0 1-.36-.15l-5.29-5.29a1.34 1.34 0 0 0-1.88 0 1.34 1.34 0 0 0 0 1.89l2.23 2.23L9.3 21.4a.5.5 0 0 1-.36.85.5.5 0 0 1-.35-.14l-3.32-3.33a1.33 1.33 0 0 0-1.89 0 1.32 1.32 0 0 0-.39.95c0 .35.14.69.4.94l6.39 6.4c3.53 3.53 8.86 5.3 12.82 1.35zM12.73 9.26l5.68 5.68-.49-1.04c-.52-1.1-.43-2.13.22-2.89l-3.3-3.3a1.34 1.34 0 0 0-1.88 0 1.33 1.33 0 0 0-.4.94c0 .22.07.42.17.61zm14.79 19.18a7.46 7.46 0 0 1-6.41 2.31 7.92 7.92 0 0 1-3.67.9c-3.05 0-6.12-1.63-8.36-3.88l-6.4-6.4A2.31 2.31 0 0 1 2 19.72a2.33 2.33 0 0 1 1.92-2.3l-.87-.87a2.34 2.34 0 0 1 0-3.3 2.33 2.33 0 0 1 1.24-.64l-.14-.14a2.34 2.34 0 0 1 0-3.3 2.39 2.39 0 0 1 3.3 0l.14.14a2.33 2.33 0 0 1 3.95-1.24l.09.09c.09-.42.29-.83.62-1.16a2.34 2.34 0 0 1 3.3 0l3.38 3.39a2.17 2.17 0 0 1 1.27-.17c.54.08 1.03.35 1.45.76.1-.55.41-1.03.9-1.42a2.12 2.12 0 0 1 1.67-.4 2.8 2.8 0 0 1 1.85 1.25l3.65 6.43c1.7 2.83 2.03 7.37-2.2 11.6zM13.22.48l-1.92.89 2.37 2.83-.45-3.72zm8.48.88L19.78.5l-.44 3.7 2.36-2.84zM16.5 3.3L15.48 0h2.04L16.5 3.3z" fill-rule="evenodd"></path></svg></button></div></div></div><div class="r nb nc nd ne nf ng nh"><div class="cd oq ni"><h4 class="bi ek cb bk ct"><button class="cg ch au av aw ax ay az ba bb ci cj be ck cl">440 claps</button></h4></div></div></div></div><div class="r or os ot ou ov"></div></div><div class="n o"><div class="ho r bh"><button class="cg ch au av aw ax ay az ba bb ci cj be ck cl"><svg width="29" height="29" class="q"><path d="M22.05 7.54a4.47 4.47 0 0 0-3.3-1.46 4.53 4.53 0 0 0-4.53 4.53c0 .35.04.7.08 1.05A12.9 12.9 0 0 1 5 6.89a5.1 5.1 0 0 0-.65 2.26c.03 1.6.83 2.99 2.02 3.79a4.3 4.3 0 0 1-2.02-.57v.08a4.55 4.55 0 0 0 3.63 4.44c-.4.08-.8.13-1.21.16l-.81-.08a4.54 4.54 0 0 0 4.2 3.15 9.56 9.56 0 0 1-5.66 1.94l-1.05-.08c2 1.27 4.38 2.02 6.94 2.02 8.3 0 12.86-6.9 12.84-12.85.02-.24 0-.43 0-.65a8.68 8.68 0 0 0 2.26-2.34c-.82.38-1.7.62-2.6.72a4.37 4.37 0 0 0 1.95-2.51c-.84.53-1.81.9-2.83 1.13z"></path></svg></button></div><div class="ho r bh"><button class="cg ch au av aw ax ay az ba bb ci cj be ck cl"><svg width="29" height="29" viewBox="0 0 29 29" fill="none" class="q"><path d="M5 6.36C5 5.61 5.63 5 6.4 5h16.2c.77 0 1.4.61 1.4 1.36v16.28c0 .75-.63 1.36-1.4 1.36H6.4c-.77 0-1.4-.6-1.4-1.36V6.36z"></path><path fill-rule="evenodd" clip-rule="evenodd" d="M10.76 20.9v-8.57H7.89v8.58h2.87zm-1.44-9.75c1 0 1.63-.65 1.63-1.48-.02-.84-.62-1.48-1.6-1.48-.99 0-1.63.64-1.63 1.48 0 .83.62 1.48 1.59 1.48h.01zM12.35 20.9h2.87v-4.79c0-.25.02-.5.1-.7.2-.5.67-1.04 1.46-1.04 1.04 0 1.46.8 1.46 1.95v4.59h2.87v-4.92c0-2.64-1.42-3.87-3.3-3.87-1.55 0-2.23.86-2.61 1.45h.02v-1.24h-2.87c.04.8 0 8.58 0 8.58z" fill="#fff"></path></svg></button></div><div class="ho r bh"><button class="cg ch au av aw ax ay az ba bb ci cj be ck cl"><svg width="29" height="29" class="q"><path d="M23.2 5H5.8a.8.8 0 0 0-.8.8V23.2c0 .44.35.8.8.8h9.3v-7.13h-2.38V13.9h2.38v-2.38c0-2.45 1.55-3.66 3.74-3.66 1.05 0 1.95.08 2.2.11v2.57h-1.5c-1.2 0-1.48.57-1.48 1.4v1.96h2.97l-.6 2.97h-2.37l.05 7.12h5.1a.8.8 0 0 0 .79-.8V5.8a.8.8 0 0 0-.8-.79"></path></svg></button></div><div class="ow r bh"><div><div class="hq"><div><div class="bx" role="tooltip" aria-hidden="true" aria-describedby="3" aria-labelledby="3"><button class="cg ch au av aw ax ay az ba bb ci cj be ck cl"><svg width="25" height="25" viewBox="0 0 25 25"><path d="M19 6a2 2 0 0 0-2-2H8a2 2 0 0 0-2 2v14.66h.01c.01.1.05.2.12.28a.5.5 0 0 0 .7.03l5.67-4.12 5.66 4.13a.5.5 0 0 0 .71-.03.5.5 0 0 0 .12-.29H19V6zm-6.84 9.97L7 19.64V6a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v13.64l-5.16-3.67a.49.49 0 0 0-.68 0z" fill-rule="evenodd"></path></svg></button></div></div></div></div></div><div class="bx" aria-hidden="true"><div class="bx" aria-hidden="true"><div class="r bh"><button class="cg ch au av aw ax ay az ba bb ci cj be ck cl"><svg width="25" height="25" viewBox="-480.5 272.5 21 21" class="q"><path d="M-463 284.6c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5zm-7-.9c.9 0 1.6-.7 1.6-1.6s-.7-1.6-1.6-1.6-1.6.7-1.6 1.6.7 1.6 1.6 1.6zm0 .9c-1.4 0-2.5-1.1-2.5-2.5s1.1-2.5 2.5-2.5 2.5 1.1 2.5 2.5-1.1 2.5-2.5 2.5z"></path></svg></button></div></div></div></div></div><div class="ox oy oz nl r pa y"><div class="r g"><div class="pb pc r cd"><span class="r pd al pe"><div class="r s pf pg"><a href="https://towardsdatascience.com/@MaxGhenis?source=follow_footer--------------------------follow_footer-" rel="noopener"><div class="cd ph ed"><div class="gm n gn o p s go gp gq gr gs ff"><svg width="91" height="91" viewBox="0 0 91 91"><path fill-rule="evenodd" clip-rule="evenodd" d="M45.5 1.4c-17.14 0-32 9.95-39.25 24.5L5 25.28C12.47 10.28 27.8 0 45.5 0S78.53 10.29 86 25.28l-1.25.62C77.5 11.35 62.65 1.4 45.5 1.4zM6.25 65.1c7.25 14.55 22.1 24.5 39.25 24.5 17.14 0 32-9.95 39.25-24.5l1.25.62C78.53 80.72 63.2 91 45.5 91S12.47 80.71 5 65.72l1.25-.62z"></path></svg></div><img alt="Max Ghenis" class="r dm ed ph" src="./Quantile regression, from linear models to trees to deep learning_files/2_7R9HC-rx2qMYDvc5HGIQEQ(1).jpeg" width="80" height="80"></div></a></div><span class="r"><div class="pi r pj"><p class="bi ek el bk bn en pk">Written by</p></div><div class="pi pl n pj"><div class="ai n o gg"><h2 class="bi it lj pm ct"><a href="https://towardsdatascience.com/@MaxGhenis?source=follow_footer--------------------------follow_footer-" class="cg ch au av aw ax ay az ba bb ci cj be ck cl" rel="noopener">Max Ghenis</a></h2><div class="r g"><button class="cs cu as at hd bc bd he bb df bi b bj bk bl bm dg dh di bx dj">Follow</button></div></div></div></span></span><div class="pi pn r pj ar"><div class="po r"><h4 class="bi ek mf pp bn">Economist studying at MIT. Focused on poverty, fiscal policy, basic income, and housing. Former Google data scientist.</h4></div><div class="aq pq ar"><button class="cs cu as at hd bc bd he bb df bi b bj bk bl bm dg dh di bx dj">Follow</button></div></div></div><div class="ox r"></div><div class="pb pc r cd"><span class="r pd al pe"><div class="r s pf pg"><a href="https://towardsdatascience.com/?source=follow_footer--------------------------follow_footer-" rel="noopener"><img alt="Towards Data Science" class="df ph ed" src="./Quantile regression, from linear models to trees to deep learning_files/1_hVxgUA6kP-PgL5TJjuyePg.png" width="80" height="80"></a></div><span class="r"><div class="pi pl n pj"><div class="ai n o gg"><h2 class="bi it lj pm ct"><a href="https://towardsdatascience.com/?source=follow_footer--------------------------follow_footer-" class="cg ch au av aw ax ay az ba bb ci cj be ck cl" rel="noopener">Towards Data Science</a></h2><div class="r g"><div class="bx" aria-hidden="true"><button class="cs cu as at hd bc bd he bb df bi b bj bk bl bm dg dh di bx dj">Follow</button></div></div></div></div></span></span><div class="pi pr r pj ar"><div class="po r"><h4 class="bi ek mf pp bn">A Medium publication sharing concepts, ideas, and codes.</h4></div><div class="aq pq ar"><div class="bx" aria-hidden="true"><button class="cs cu as at hd bc bd he bb df bi b bj bk bl bm dg dh di bx dj">Follow</button></div></div></div></div></div><div class="aq ar"><div class="ps r"><div class="n gn"><div class="pt r"><a href="https://towardsdatascience.com/@MaxGhenis?source=follow_footer--------------------------follow_footer-" rel="noopener"><div class="cd pu pv"><div class="gm n gn o p s go gp gq gr gs ff"><svg width="49" height="49" viewBox="0 0 49 49"><path fill-rule="evenodd" clip-rule="evenodd" d="M24.5 1.1c-9.39 0-17.53 5.55-21.51 13.66L2 14.28C6.15 5.82 14.66 0 24.5 0S42.85 5.82 47 14.28l-.99.48C42.03 6.65 33.9 1.1 24.5 1.1zM2.99 34.24C6.97 42.35 15.1 47.9 24.5 47.9c9.39 0 17.53-5.55 21.51-13.66l.99.48C42.85 43.18 34.34 49 24.5 49S6.15 43.18 2 34.72l.99-.48z"></path></svg></div><img alt="Max Ghenis" class="r dm pv pu" src="./Quantile regression, from linear models to trees to deep learning_files/2_7R9HC-rx2qMYDvc5HGIQEQ(2).jpeg" width="40" height="40"></div></a></div><div class="gt r"><p class="bi ek pw px bn en pk">Written by</p><div class="n gn"><h2 class="bi it mf bk ct"><a href="https://towardsdatascience.com/@MaxGhenis?source=follow_footer--------------------------follow_footer-" class="cg ch au av aw ax ay az ba bb ci cj be ck cl" rel="noopener">Max Ghenis</a></h2><div class="gt r"><button class="hc cu as at hd bc bd he bb df bi b bj hf el bm dg dh di bx dj">Follow</button></div></div><div class="py r"><h4 class="bi ek cb bk bn">Economist studying at MIT. Focused on poverty, fiscal policy, basic income, and housing. Former Google data scientist.</h4></div></div></div><div class="ps r"><div class="n gn"><a href="https://towardsdatascience.com/?source=follow_footer--------------------------follow_footer-" rel="noopener"><img alt="Towards Data Science" class="df pu pv" src="./Quantile regression, from linear models to trees to deep learning_files/1_hVxgUA6kP-PgL5TJjuyePg(1).png" width="40" height="40"></a><div class="gt r"><div class="n gn"><h2 class="bi it mf bk ct"><a href="https://towardsdatascience.com/?source=follow_footer--------------------------follow_footer-" class="cg ch au av aw ax ay az ba bb ci cj be ck cl" rel="noopener">Towards Data Science</a></h2><div class="gt r"><div class="bx" aria-hidden="true"><button class="hc cu as at hd bc bd he bb df bi b bj hf el bm dg dh di bx dj">Follow</button></div></div></div><div class="py r"><h4 class="bi ek cb bk bn">A Medium publication sharing concepts, ideas, and codes.</h4></div></div></div></div></div></div></div><div class="pz oy r pa qa y"><a href="https://medium.com/p/af3738b527c3/responses/show?source=follow_footer--------------------------follow_footer-" class="cg ch au av aw ax ay az ba bb ci cj be ck cl" rel="noopener"><span class="qb qc mv"><div class="kt qd df r lm ar"><span class="as">See responses (6)</span></div></span></a></div></div></div><div class="qe r qf y"><div class="n p"><div class="z ab ac ae af ag ah ai"></div></div></div></div></div><div class="qg r qh qi"><section class="ez fa ai di r qj qk ql qm qn qo qp qq qr qs qt qu qv qw qx"><div class="qy qz pb n gg g"><div class="ra n gg"><div class="rb r rc"><div class="rd r"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----af3738b527c3----------------------" class="cg ch au av aw ax ay az ba bb re rf be rg rh" rel="noopener"><h4 class="ri rj rk bi it bj pp rl rm r">Discover <!-- -->Medium</h4></a></div><span class="bi b bj bk bl bm r rn ro">Welcome to a place where words matter. On <!-- -->Medium<!-- -->, smart voices and original ideas take center stage - with no ads in sight.<!-- --> <a href="https://medium.com/about?autoplay=1&amp;source=post_page-----af3738b527c3----------------------" class="cg ch au av aw ax ay az ba bb be rg rh rp" rel="noopener">Watch</a></span></div><div class="rb r rc"><div class="rq r"><a href="https://medium.com/topics?source=post_page-----af3738b527c3----------------------" class="cg ch au av aw ax ay az ba bb re rf be rg rh" rel="noopener"><h4 class="ri rj rk bi it bj pp rl rm r">Make <!-- -->Medium<!-- --> yours</h4></a></div><span class="bi b bj bk bl bm r rn ro">Follow all the topics you care about, and we’ll deliver the best stories for you to your homepage and inbox.<!-- --> <a href="https://medium.com/topics?source=post_page-----af3738b527c3----------------------" class="cg ch au av aw ax ay az ba bb be rg rh rp" rel="noopener">Explore</a></span></div><div class="rb r rc"><div class="rd r"><a href="https://medium.com/membership?source=post_page-----af3738b527c3----------------------" class="cg ch au av aw ax ay az ba bb re rf be rg rh" rel="noopener"><h4 class="ri rj rk bi it bj pp rl rm r">Become a member</h4></a></div><span class="bi b bj bk bl bm r rn ro">Get unlimited access to the best stories on <!-- -->Medium<!-- --> — and support writers while you’re at it. Just $5/month.<!-- --> <a href="https://medium.com/membership?source=post_page-----af3738b527c3----------------------" class="cg ch au av aw ax ay az ba bb be rg rh rp" rel="noopener">Upgrade</a></span></div></div></div><div class="n mc"><div class="n o gg"><a href="https://medium.com/?source=post_page-----af3738b527c3----------------------" class="cg ch au av aw ax ay az ba bb re rf be rg rh" rel="noopener"><svg height="22" width="112" viewBox="0 0 111.5 22" class="rj"><path d="M56.3 19.5c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5V19c-.7 1.8-2.4 3-4.3 3-3.3 0-5.8-2.6-5.8-7.5 0-4.5 2.6-7.6 6.3-7.6 1.6-.1 3.1.8 3.8 2.4V3.2c0-.3-.1-.6-.3-.7l-1.4-1.4V1l6.5-.8v19.3zm-4.8-.8V9.5c-.5-.6-1.2-.9-1.9-.9-1.6 0-3.1 1.4-3.1 5.7 0 4 1.3 5.4 3 5.4.8.1 1.6-.3 2-1zm9.1 3.1V9.4c0-.3-.1-.6-.3-.7l-1.4-1.5v-.1h6.5v12.5c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5zm-.2-19.2C60.4 1.2 61.5 0 63 0c1.4 0 2.6 1.2 2.6 2.6S64.4 5.3 63 5.3a2.6 2.6 0 0 1-2.6-2.7zm22.5 16.9c0 .4 0 .5.3.7l1.5 1.4v.1h-6.5v-3.2c-.6 2-2.4 3.4-4.5 3.4-2.9 0-4.4-2.1-4.4-6.2 0-1.9 0-4.1.1-6.5 0-.3-.1-.5-.3-.7L67.7 7v.1H74v8c0 2.6.4 4.4 2 4.4.9-.1 1.7-.6 2.1-1.3V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v12.4zm22 2.3c0-.5.1-6.5.1-7.9 0-2.6-.4-4.5-2.2-4.5-.9 0-1.8.5-2.3 1.3.2.8.3 1.7.3 2.5 0 1.8-.1 4.2-.1 6.5 0 .3.1.5.3.7l1.5 1.4v.1H96c0-.4.1-6.5.1-7.9 0-2.7-.4-4.5-2.2-4.5-.9 0-1.7.5-2.2 1.3v9c0 .4 0 .5.3.7l1.4 1.4v.1h-6.5V9.5c0-.3-.1-.6-.3-.7l-1.4-1.5v-.2h6.5v3.1a4.6 4.6 0 0 1 4.6-3.4c2.2 0 3.6 1.2 4.2 3.5.7-2.1 2.7-3.6 4.9-3.5 2.9 0 4.5 2.2 4.5 6.2 0 1.9-.1 4.2-.1 6.5-.1.3.1.6.3.7l1.4 1.4v.1h-6.6zm-81.4-2l1.9 1.9v.1h-9.8v-.1l2-1.9c.2-.2.3-.4.3-.7V7.3c0-.5 0-1.2.1-1.8L11.4 22h-.1L4.5 6.8c-.1-.4-.2-.4-.3-.6v10c-.1.7 0 1.3.3 1.9l2.7 3.6v.1H0v-.1L2.7 18c.3-.6.4-1.3.3-1.9v-11c0-.5-.1-1.1-.5-1.5L.7 1.1V1h7l5.8 12.9L18.6 1h6.8v.1l-1.9 2.2c-.2.2-.3.5-.3.7v15.2c0 .2.1.5.3.6zm7.6-5.9c0 3.8 1.9 5.3 4.2 5.3 1.9.1 3.6-1 4.4-2.7h.1c-.8 3.7-3.1 5.5-6.5 5.5-3.7 0-7.2-2.2-7.2-7.4 0-5.5 3.5-7.6 7.3-7.6 3.1 0 6.4 1.5 6.4 6.2v.8h-8.7zm0-.8h4.3v-.8c0-3.9-.8-4.9-2-4.9-1.4.1-2.3 1.6-2.3 5.7z"></path></svg></a><span class="bi b bj bk bl bm r rn ro"><div class="py rr n gg rs al"><h4 class="bi ek mf pp ri"><a href="https://medium.com/about?autoplay=1&amp;source=post_page-----af3738b527c3----------------------" class="cg ch au av aw ax ay az ba bb ha be rg rh" rel="noopener">About</a></h4><h4 class="bi ek mf pp ri"><a href="https://help.medium.com/?source=post_page-----af3738b527c3----------------------" class="cg ch au av aw ax ay az ba bb ha be rg rh" rel="noopener">Help</a></h4><h4 class="bi ek mf pp ri"><a href="https://medium.com/policy/9db0094a1e0f?source=post_page-----af3738b527c3----------------------" class="cg ch au av aw ax ay az ba bb ha be rg rh" rel="noopener">Legal</a></h4></div></span></div><div class="aq rt ru al"><h4 class="bi ek mf pp rn">Get the Medium app</h4></div><div class="aq rt rv al rw"><div class="cq r"><a href="https://itunes.apple.com/app/medium-everyones-stories/id828256236?pt=698524&amp;mt=8&amp;ct=post_page&amp;source=post_page-----af3738b527c3----------------------" class="cg ch au av aw ax ay az ba bb re rf be rg rh" rel="noopener nofollow"><img alt="A button that says &#39;Download on the App Store&#39;, and if clicked it will lead you to the iOS App store" class="" src="./Quantile regression, from linear models to trees to deep learning_files/1_M2FVPPidy2x386MRAE-EeA.png" width="135" height="41"></a></div><div class="r"><a href="https://play.google.com/store/apps/details?id=com.medium.reader&amp;source=post_page-----af3738b527c3----------------------" class="cg ch au av aw ax ay az ba bb re rf be rg rh" rel="noopener nofollow"><img alt="A button that says &#39;Get it on, Google Play&#39;, and if clicked it will lead you to the Google Play store" class="" src="./Quantile regression, from linear models to trees to deep learning_files/1_HyH8oIcJvXp7xzu5oF6dTg.png" width="135" height="41"></a></div></div></div></section></div></div></div><script>window.__BUILD_ID__ = "master-20200612-182323-800caa66e7"</script><script>window.__GRAPHQL_URI__ = "https://towardsdatascience.com/_/graphql"</script><script>window.__PRELOADED_STATE__ = {"config":{"nodeEnv":"production","version":"master-20200612-182323-800caa66e7","productName":"Medium","publicUrl":"https:\u002F\u002Fcdn-client.medium.com\u002Flite","authDomain":"medium.com","authGoogleClientId":"216296035834-k1k6qe060s2tp2a2jam4ljdcms00sttg.apps.googleusercontent.com","favicon":"production","glyphUrl":"https:\u002F\u002Fglyph.medium.com","branchKey":"key_live_ofxXr2qTrrU9NqURK8ZwEhknBxiI6KBm","lightStep":{"name":"lite-web","host":"lightstep.medium.systems","token":"ce5be895bef60919541332990ac9fef2","appVersion":"master-20200612-182323-800caa66e7"},"algolia":{"appId":"MQ57UUUQZ2","apiKeySearch":"394474ced050e3911ae2249ecc774921","indexPrefix":"medium_","host":"-dsn.algolia.net"},"recaptchaKey":"6Lfc37IUAAAAAKGGtC6rLS13R1Hrw_BqADfS1LRk","recaptcha3Key":"6Lf8R9wUAAAAABMI_85Wb8melS7Zj6ziuf99Yot5","datadog":{"clientToken":"pub853ea8d17ad6821d9f8f11861d23dfed","context":{"deployment":{"target":"production","tag":"master-20200612-182323-800caa66e7","commit":"800caa66e7698dabe86b299b8d0a1d5e9457c067"}},"datacenter":"us"},"isAmp":false,"googleAnalyticsCode":"UA-24232453-2","signInWallCustomDomainCollectionIds":["3a8144eabfe3","336d898217ee","61061eb0c96b","138adf9c44c","819cc2aaeee0"],"mediumOwnedAndOperatedCollectionIds":["544c7006046e","bcc38c8f6edf","444d13b52878","8d6b8a439e32","92d2092dc598","1285ba81cada","cb8577c9149e","8ccfed20cbb2","ae2a65f35510","3f6ecf56618","7b6769f2748b","fc8964313712","ef8e90590e66","191186aaafa0","d944778ce714","bdc4052bbdba","88d9857e584e","9dc80918cc93"],"tierOneDomains":["medium.com","thebolditalic.com","arcdigital.media","towardsdatascience.com","uxdesign.cc","codeburst.io","psiloveyou.xyz","writingcooperative.com","entrepreneurshandbook.co","prototypr.io","betterhumans.coach.me","theascent.pub"],"defaultImages":{"avatar":{"imageId":"1*dmbNkD5D-u45r44go_cf0g.png","height":150,"width":150},"orgLogo":{"imageId":"1*OMF3fSqH8t4xBJ9-6oZDZw.png","height":106,"width":545},"postLogo":{"imageId":"1*3sela1OADrJr7dJk_CXaEQ.png","height":810,"width":1440},"postPreviewImage":{"imageId":"1*hn4v1tCaJy7cWMyb0bpNpQ.png","height":386,"width":579}},"performanceTags":[],"collectionStructuredData":{"8d6b8a439e32":{"name":"Elemental","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F980\u002F1*9ygdqoKprhwuTVKUM0DLPA@2x.png","width":980,"height":159}}},"3f6ecf56618":{"name":"Forge","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F596\u002F1*uULpIlImcO5TDuBZ6lm7Lg@2x.png","width":596,"height":183}}},"ae2a65f35510":{"name":"GEN","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F264\u002F1*RdVZMdvfV3YiZTw6mX7yWA.png","width":264,"height":140}}},"88d9857e584e":{"name":"LEVEL","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*JqYMhNX6KNNb2UlqGqO2WQ.png","width":540,"height":108}}},"7b6769f2748b":{"name":"Marker","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fcdn-images-1.medium.com\u002Fmax\u002F383\u002F1*haCUs0wF6TgOOvfoY-jEoQ@2x.png","width":383,"height":92}}},"444d13b52878":{"name":"OneZero","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*cw32fIqCbRWzwJaoQw6BUg.png","width":540,"height":123}}},"8ccfed20cbb2":{"name":"Zora","data":{"@type":"NewsMediaOrganization","ethicsPolicy":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Farticles\u002F360043290473","logo":{"@type":"ImageObject","url":"https:\u002F\u002Fmiro.medium.com\u002Fmax\u002F540\u002F1*tZUQqRcCCZDXjjiZ4bDvgQ.png","width":540,"height":106}}}},"embeddedPostIds":{"coronavirus":"cd3010f9d81f"},"sharedCdcMessaging":{"COVID_APPLICABLE_TAG_SLUGS":["pandemic","epidemic","coronavirus","covid19","co-vid-19","containment","self-care","flatten-the-curve","public-health","virus","public-health-crisis","quarantine","self-quarantine","zika","corona","disease-prevention","wuhan","chinavirus","outbreak","influenza","socialdistancing","social-distance","flu","vaccines","healthcare","medicine","conspiracy-theories","conspiracy","virality","epidemia","pandemia","salud","corona-e-virus","coronavirus-covid19","covid-19","covid-19-symptoms","covid-19-crisis","covid-19-testing","covid-19-treatment","coronavirus-update","coronavirus-diaries"],"COVID_APPLICABLE_TOPIC_NAMES":["coronavirus"],"COVID_APPLICABLE_TOPIC_NAMES_FOR_TOPIC_PAGE":["coronavirus","health"],"COVID_MESSAGES":{"tierA":{"text":"For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":66,"end":73,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"tierB":{"text":"Anyone can publish on Medium per our Policies, but we don’t fact-check every story. For more info about the coronavirus, see cdc.gov.","markups":[{"start":37,"end":45,"href":"https:\u002F\u002Fhelp.medium.com\u002Fhc\u002Fen-us\u002Fcategories\u002F201931128-Policies-Safety"},{"start":125,"end":132,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]},"paywall":{"text":"This article has been made free for everyone, thanks to Medium Members. For more information on the novel coronavirus and Covid-19, visit cdc.gov.","markups":[{"start":56,"end":70,"href":"https:\u002F\u002Fmedium.com\u002Fmembership"},{"start":138,"end":145,"href":"https:\u002F\u002Fwww.cdc.gov\u002Fcoronavirus\u002F2019-nCoV"}]}},"COVID_BANNER_POST_ID_OVERRIDE_WHITELIST":["3b31a67bff4a"]},"embedPostRules":[],"recircOptions":{"v1":{"limit":3},"v2":{"limit":8}},"braintreeClientKey":"production_zjkj96jm_m56f8fqpf7ngnrd4"},"debug":{"requestId":"07cc009e-5fe0-92e6-b881-f0668c5f50bf","edge":"","originalSpanCarrier":{"ot-tracer-spanid":"74c7f03f23695a0e","ot-tracer-traceid":"53d1e0045b9c06a3","ot-tracer-sampled":"true"}},"session":{"user":{"id":"2d9a645dd6b0"},"xsrf":"qLuDHBXdUOFx","isSpoofed":false},"stats":{"itemCount":0,"sending":false,"timeout":null,"backup":{}},"navigation":{"branch":{"show":null,"hasRendered":null,"blockedByCTA":false},"hideGoogleOneTap":false,"hasRenderedGoogleOneTap":null,"hasRenderedAlternateUserBanner":null,"currentLocation":"https:\u002F\u002Ftowardsdatascience.com\u002Fquantile-regression-from-linear-models-to-trees-to-deep-learning-af3738b527c3","host":"towardsdatascience.com","hostname":"towardsdatascience.com","referrer":"https:\u002F\u002Fwww.google.com\u002F","susiModal":{"step":null,"operation":"register"},"postRead":false},"client":{"isBot":false,"isCustomDomain":true,"isEu":true,"isNativeMedium":false,"isSafariMobile":false,"inAppBrowserName":"","supportsWebp":true},"multiVote":{"clapsPerPost":{}},"tracing":{}}</script><script>window.__APOLLO_STATE__ = {"ROOT_QUERY.variantFlags.0":{"name":"add_friction_to_signup","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.0.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.0.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.1":{"name":"allow_access","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.1.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.1.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.2":{"name":"allow_signup","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.2.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.2.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.3":{"name":"allow_test_auth","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.3.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.3.valueType":{"__typename":"VariantFlagString","value":"disallow"},"ROOT_QUERY.variantFlags.4":{"name":"assign_default_topic_to_posts","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.4.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.4.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.5":{"name":"available_annual_plan","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.5.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.5.valueType":{"__typename":"VariantFlagString","value":"2c754bcc2995"},"ROOT_QUERY.variantFlags.6":{"name":"available_monthly_plan","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.6.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.6.valueType":{"__typename":"VariantFlagString","value":"60e220181034"},"ROOT_QUERY.variantFlags.7":{"name":"bane_add_user","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.7.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.7.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.8":{"name":"branch_seo_metadata","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.8.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.8.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.9":{"name":"browsable_stream_config_bucket","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.9.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.9.valueType":{"__typename":"VariantFlagString","value":"curated-topics"},"ROOT_QUERY.variantFlags.10":{"name":"coronavirus_topic_recirc","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.10.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.10.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.11":{"name":"covid_19_cdc_banner","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.11.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.11.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.12":{"name":"disable_android_subscription_activity_carousel","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.12.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.12.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.13":{"name":"disable_gosocial_followers_that_you_follow","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.13.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.13.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.14":{"name":"disable_ios_resume_reading_toast","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.14.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.14.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.15":{"name":"disable_ios_subscription_activity_carousel","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.15.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.15.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.16":{"name":"disable_mobile_featured_chunk","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.16.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.16.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.17":{"name":"disable_post_recommended_from_friends_provider","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.17.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.17.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.18":{"name":"enable_android_local_currency","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.18.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.18.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.19":{"name":"enable_annual_renewal_reminder_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.19.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.19.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.20":{"name":"enable_app_flirty_thirty","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.20.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.20.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.21":{"name":"enable_apple_sign_in","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.21.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.21.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.22":{"name":"enable_automated_mission_control_triggers","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.22.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.22.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.23":{"name":"enable_braintree_integration","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.23.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.23.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.24":{"name":"enable_braintree_webhook","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.24.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.24.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.25":{"name":"enable_branch_io","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.25.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.25.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.26":{"name":"enable_branding","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.26.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.26.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.27":{"name":"enable_branding_fonts","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.27.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.27.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.28":{"name":"enable_cc_trial_member_onboarding_emails","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.28.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.28.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.29":{"name":"enable_cleansweep_cachev2_reads","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.29.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.29.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.30":{"name":"enable_cleansweep_double_writes","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.30.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.30.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.31":{"name":"enable_confirm_sign_in","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.31.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.31.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.32":{"name":"enable_cta_meter","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.32.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.32.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.33":{"name":"enable_curation_priority_queue_experiment","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.33.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.33.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.34":{"name":"enable_dedicated_series_tab_api_ios","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.34.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.34.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.35":{"name":"enable_different_grid","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.35.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.35.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.36":{"name":"enable_digest_feature_logging","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.36.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.36.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.37":{"name":"enable_digest_tagline","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.37.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.37.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.38":{"name":"enable_disregard_trunc_state_for_footer","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.38.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.38.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.39":{"name":"enable_edit_alt_text","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.39.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.39.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.40":{"name":"enable_email_sign_in_captcha","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.40.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.40.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.41":{"name":"enable_embedding_based_diversification","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.41.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.41.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.42":{"name":"enable_end_of_post_cleanup","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.42.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.42.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.43":{"name":"enable_expanded_feature_chunk_pool","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.43.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.43.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.44":{"name":"enable_filter_by_resend_rules","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.44.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.44.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.45":{"name":"enable_filter_expire_processor","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.45.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.45.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.46":{"name":"enable_first_name_on_paywall","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.46.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.46.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.47":{"name":"enable_footer_app_buttons","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.47.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.47.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.48":{"name":"enable_free_corona_topic","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.48.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.48.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.49":{"name":"enable_global_susi_modal","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.49.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.49.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.50":{"name":"enable_google_one_tap","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.50.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.50.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.51":{"name":"enable_highlander_member_digest","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.51.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.51.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.52":{"name":"enable_icelandic_truncated_posts","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.52.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.52.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.53":{"name":"enable_ios_post_stats","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.53.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.53.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.54":{"name":"enable_janky_spam_rules","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.54.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.54.valueType":{"__typename":"VariantFlagString","value":"users,posts"},"ROOT_QUERY.variantFlags.55":{"name":"enable_json_logs_trained_ranker","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.55.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.55.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.56":{"name":"enable_kbfd_rex","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.56.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.56.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.57":{"name":"enable_kbfd_rex_app_highlights","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.57.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.57.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.58":{"name":"enable_kbfd_rex_daily_digest","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.58.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.58.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.59":{"name":"enable_li_open_in_app","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.59.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.59.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.60":{"name":"enable_lite_about_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.60.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.60.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.61":{"name":"enable_lite_notifications","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.61.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.61.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.62":{"name":"enable_lite_post","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.62.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.62.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.63":{"name":"enable_lite_post_cd","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.63.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.63.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.64":{"name":"enable_lite_post_highlights","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.64.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.64.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.65":{"name":"enable_lite_post_highlights_view_only","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.65.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.65.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.66":{"name":"enable_lite_profile","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.66.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.66.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.67":{"name":"enable_lite_pub_header_menu","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.67.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.67.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.68":{"name":"enable_lite_pub_homepage_for_selected_domains","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.68.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.68.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.69":{"name":"enable_lite_server_upstream_deadlines","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.69.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.69.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.70":{"name":"enable_lite_stories","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.70.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.70.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.71":{"name":"enable_lite_topics","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.71.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.71.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.72":{"name":"enable_lite_unread_notification_count_mutation","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.72.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.72.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.73":{"name":"enable_lo_open_in_app","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.73.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.73.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.74":{"name":"enable_login_code_flow","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.74.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.74.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.75":{"name":"enable_m2_unviewable_filter","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.75.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.75.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.76":{"name":"enable_marketing_emails","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.76.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.76.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.77":{"name":"enable_media_resource_try_catch","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.77.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.77.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.78":{"name":"enable_member_onboarding","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.78.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.78.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.79":{"name":"enable_membership_remove_section_a","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.79.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.79.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.80":{"name":"enable_miro_on_kubernetes","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.80.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.80.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.81":{"name":"enable_ml_rank_modules","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.81.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.81.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.82":{"name":"enable_ml_rank_rex_anno","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.82.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.82.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.83":{"name":"enable_monthly_member_onboarding_emails","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.83.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.83.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.84":{"name":"enable_more_on_coronavirus","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.84.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.84.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.85":{"name":"enable_mute","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.85.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.85.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.86":{"name":"enable_new_collaborative_filtering_data","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.86.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.86.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.87":{"name":"enable_new_suspended_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.87.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.87.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.88":{"name":"enable_new_three_dot_menu","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.88.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.88.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.89":{"name":"enable_newsletter_v3","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.89.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.89.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.90":{"name":"enable_olsen","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.90.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.90.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.91":{"name":"enable_open_in_app_regwall","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.91.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.91.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.92":{"name":"enable_optimizely","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.92.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.92.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.93":{"name":"enable_orion","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.93.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.93.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.94":{"name":"enable_parsely","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.94.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.94.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.95":{"name":"enable_patronus_on_kubernetes","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.95.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.95.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.96":{"name":"enable_popularity_feature","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.96.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.96.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.97":{"name":"enable_post_import","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.97.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.97.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.98":{"name":"enable_post_page_nav_stickiness_removal","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.98.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.98.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.99":{"name":"enable_post_seo_settings_screen","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.99.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.99.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.100":{"name":"enable_post_settings_screen","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.100.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.100.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.101":{"name":"enable_primary_topic_for_mobile","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.101.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.101.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.102":{"name":"enable_responses_2","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.102.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.102.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.103":{"name":"enable_rito_upstream_deadlines","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.103.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.103.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.104":{"name":"enable_rtr_channel","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.104.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.104.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.105":{"name":"enable_save_to_medium","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.105.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.105.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.106":{"name":"enable_send_event_for_active_users_only","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.106.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.106.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.107":{"name":"enable_sepia_to_olsen","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.107.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.107.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.108":{"name":"enable_sisko","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.108.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.108.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.109":{"name":"enable_starspace","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.109.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.109.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.110":{"name":"enable_starspace_ranker_starspace","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.110.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.110.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.111":{"name":"enable_stripe_idempotent_subscription_requests","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.111.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.111.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.112":{"name":"enable_theme_editor","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.112.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.112.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.113":{"name":"enable_tick_landing_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.113.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.113.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.114":{"name":"enable_tipalti_onboarding","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.114.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.114.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.115":{"name":"enable_topic_lifecycle_email","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.115.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.115.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.116":{"name":"enable_tribute_landing_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.116.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.116.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.117":{"name":"enable_trumpland_landing_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.117.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.117.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.118":{"name":"enable_utc_fix_on_partner_program_dashboard","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.118.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.118.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.119":{"name":"filter_low_scoring_users","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.119.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.119.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.120":{"name":"glyph_embed_commands","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.120.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.120.valueType":{"__typename":"VariantFlagString","value":"control"},"ROOT_QUERY.variantFlags.121":{"name":"glyph_font_set","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.121.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.121.valueType":{"__typename":"VariantFlagString","value":"m2"},"ROOT_QUERY.variantFlags.122":{"name":"google_sign_in_android","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.122.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.122.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.123":{"name":"ios_pub_follow_email_opt_in","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.123.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.123.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.124":{"name":"is_not_medium_subscriber","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.124.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.124.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.125":{"name":"limit_post_referrers","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.125.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.125.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.126":{"name":"make_nav_sticky","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.126.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.126.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.127":{"name":"new_transition_page","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.127.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.127.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.128":{"name":"pub_sidebar","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.128.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.128.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.129":{"name":"remove_email_opt_in_on_pub_follow","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.129.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.129.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.130":{"name":"remove_post_post_similarity","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.130.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.130.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.131":{"name":"retrained_ranker","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.131.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.131.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.132":{"name":"share_post_linkedin","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.132.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.132.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.133":{"name":"sign_up_with_email_button","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.133.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.133.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.134":{"name":"signin_services","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.134.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.134.valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"},"ROOT_QUERY.variantFlags.135":{"name":"signup_services","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.135.valueType","typename":"VariantFlagString"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.135.valueType":{"__typename":"VariantFlagString","value":"twitter,facebook,google,email,google-fastidv,google-one-tap,apple"},"ROOT_QUERY.variantFlags.136":{"name":"skip_sign_in_recaptcha","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.136.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.136.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.137":{"name":"sourcing_refactor_2","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.137.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.137.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.138":{"name":"use_new_admin_topic_backend","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.138.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.138.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY.variantFlags.139":{"name":"xgboost_auto_suspend","valueType":{"type":"id","generated":true,"id":"$ROOT_QUERY.variantFlags.139.valueType","typename":"VariantFlagBoolean"},"__typename":"VariantFlag"},"$ROOT_QUERY.variantFlags.139.valueType":{"__typename":"VariantFlagBoolean","value":true},"ROOT_QUERY":{"variantFlags":[{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.0","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.1","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.2","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.3","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.4","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.5","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.6","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.7","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.8","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.9","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.10","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.11","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.12","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.13","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.14","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.15","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.16","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.17","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.18","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.19","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.20","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.21","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.22","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.23","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.24","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.25","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.26","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.27","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.28","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.29","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.30","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.31","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.32","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.33","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.34","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.35","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.36","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.37","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.38","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.39","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.40","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.41","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.42","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.43","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.44","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.45","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.46","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.47","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.48","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.49","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.50","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.51","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.52","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.53","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.54","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.55","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.56","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.57","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.58","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.59","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.60","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.61","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.62","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.63","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.64","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.65","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.66","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.67","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.68","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.69","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.70","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.71","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.72","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.73","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.74","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.75","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.76","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.77","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.78","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.79","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.80","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.81","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.82","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.83","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.84","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.85","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.86","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.87","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.88","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.89","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.90","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.91","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.92","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.93","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.94","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.95","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.96","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.97","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.98","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.99","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.100","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.101","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.102","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.103","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.104","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.105","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.106","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.107","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.108","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.109","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.110","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.111","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.112","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.113","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.114","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.115","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.116","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.117","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.118","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.119","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.120","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.121","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.122","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.123","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.124","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.125","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.126","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.127","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.128","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.129","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.130","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.131","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.132","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.133","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.134","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.135","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.136","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.137","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.138","typename":"VariantFlag"},{"type":"id","generated":true,"id":"ROOT_QUERY.variantFlags.139","typename":"VariantFlag"}],"viewer":{"type":"id","generated":false,"id":"User:2d9a645dd6b0","typename":"User"},"meterPost({\"postId\":\"af3738b527c3\",\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}})":{"type":"id","generated":false,"id":"MeteringInfo:singleton","typename":"MeteringInfo"},"postResult({\"id\":\"af3738b527c3\"})":{"type":"id","generated":false,"id":"Post:af3738b527c3","typename":"Post"}},"User:2d9a645dd6b0":{"id":"2d9a645dd6b0","username":"kiryl2009","name":"Kiryl","imageId":"0*F7rq1F1Sl0nzHJKe.jpg","mediumMemberAt":0,"hasPastMemberships":false,"isPartnerProgramEnrolled":false,"email":"kiryl2009@hotmail.com","unverifiedEmail":"","createdAt":1564492117174,"isEligibleToViewNewResponses":false,"isMembershipTrialEligible":true,"isSuspended":false,"__typename":"User"},"MeteringInfo:singleton":{"__typename":"MeteringInfo","postIds":{"type":"json","json":[]},"maxUnlockCount":3,"unlocksRemaining":3},"Post:af3738b527c3":{"__typename":"Post","id":"af3738b527c3","mediumUrl":"https:\u002F\u002Ftowardsdatascience.com\u002Fquantile-regression-from-linear-models-to-trees-to-deep-learning-af3738b527c3","canonicalUrl":"","collection":{"type":"id","generated":false,"id":"Collection:7f60cf5620c9","typename":"Collection"},"content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}})":{"type":"id","generated":true,"id":"$Post:af3738b527c3.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}})","typename":"PostContent"},"creator":{"type":"id","generated":false,"id":"User:11ca8872d783","typename":"User"},"firstPublishedAt":1539732848253,"isLocked":false,"isPublished":true,"layerCake":3,"primaryTopic":{"type":"id","generated":false,"id":"machine-learning","typename":"Topic"},"title":"Quantile regression, from linear models to trees to deep learning","latestPublishedVersion":"d0422900bcf5","visibility":"PUBLIC","isLimitedState":false,"sequence":null,"pendingCollection":null,"shareKey":null,"statusForCollection":"APPROVED","readingTime":7.022641509433962,"readingList":"READING_LIST_NONE","allowResponses":true,"clapCount":440,"viewerClapCount":null,"voterCount":135,"recommenders":[],"license":"ALL_RIGHTS_RESERVED","tags":[{"type":"id","generated":false,"id":"Tag:machine-learning","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:predictive-analytics","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:deep-learning","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:regression","typename":"Tag"},{"type":"id","generated":false,"id":"Tag:tensorflow","typename":"Tag"}],"topics":[{"type":"id","generated":false,"id":"1eca0103fff3","typename":"Topic"},{"type":"id","generated":false,"id":"ae5d4995e225","typename":"Topic"}],"postResponses":{"type":"id","generated":true,"id":"$Post:af3738b527c3.postResponses","typename":"PostResponses"},"responsesCount":6,"collaborators":[],"translationSourcePost":null,"newsletterId":"","inResponseToPostResult":null,"inResponseToMediaResource":null,"lockedSource":"LOCKED_POST_SOURCE_NONE","curationEligibleAt":0,"isDistributionAlertDismissed":false,"audioVersionUrl":"","socialTitle":"","socialDek":"","metaDescription":"","latestPublishedAt":1579369097509,"previewContent":{"type":"id","generated":true,"id":"$Post:af3738b527c3.previewContent","typename":"PreviewContent"},"previewImage":{"type":"id","generated":false,"id":"ImageMetadata:0*ufWnnvTA9AkjKrfI","typename":"ImageMetadata"},"isShortform":false,"seoTitle":"","updatedAt":1579369097954,"shortformType":"SHORTFORM_TYPE_LINK","seoDescription":"","isSuspended":false},"Collection:7f60cf5620c9":{"id":"7f60cf5620c9","domain":"towardsdatascience.com","googleAnalyticsId":null,"slug":"towards-data-science","customStyleSheet":null,"colorBehavior":"ACCENT_COLOR_AND_FILL_BACKGROUND","isAuroraPilot":false,"isAuroraVisible":false,"favicon":{"type":"id","generated":false,"id":"ImageMetadata:1*ChFMdf--f5jbm-AYv6VdYA@2x.png","typename":"ImageMetadata"},"isAuroraEligible":false,"viewerIsEditor":false,"__typename":"Collection","name":"Towards Data Science","logo":{"type":"id","generated":false,"id":"ImageMetadata:1*mG6i4Bh_LgixUYXJgQpYsg@2x.png","typename":"ImageMetadata"},"avatar":{"type":"id","generated":false,"id":"ImageMetadata:1*hVxgUA6kP-PgL5TJjuyePg.png","typename":"ImageMetadata"},"isEnrolledInHightower":false,"newsletterV3":{"type":"id","generated":false,"id":"NewsletterV3:d6fe9076899","typename":"NewsletterV3"},"creator":{"type":"id","generated":false,"id":"User:895063a310f4","typename":"User"},"navItems":[{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.0","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.1","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.2","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.3","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.4","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.5","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.6","typename":"NavItem"},{"type":"id","generated":true,"id":"Collection:7f60cf5620c9.navItems.7","typename":"NavItem"}],"colorPalette":{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette","typename":"ColorPalette"},"description":"A Medium publication sharing concepts, ideas, and codes.","shortDescription":"A Medium publication sharing concepts, ideas, and codes.","tagline":"A Medium publication sharing concepts, ideas, and codes.","viewerIsFollowing":false,"viewerIsSubscribedToLetters":false,"canToggleEmail":true,"isUserSubscribedToCollectionEmails":false,"viewerCanEditOwnPosts":false,"viewerCanEditPosts":false,"viewerIsMuting":false,"ampEnabled":false,"twitterUsername":"TDataScience","facebookPageId":null},"ImageMetadata:1*ChFMdf--f5jbm-AYv6VdYA@2x.png":{"id":"1*ChFMdf--f5jbm-AYv6VdYA@2x.png","__typename":"ImageMetadata"},"ImageMetadata:1*mG6i4Bh_LgixUYXJgQpYsg@2x.png":{"id":"1*mG6i4Bh_LgixUYXJgQpYsg@2x.png","originalWidth":337,"originalHeight":122,"__typename":"ImageMetadata"},"ImageMetadata:1*hVxgUA6kP-PgL5TJjuyePg.png":{"id":"1*hVxgUA6kP-PgL5TJjuyePg.png","__typename":"ImageMetadata"},"NewsletterV3:d6fe9076899":{"id":"d6fe9076899","slug":"monthly-edition","__typename":"NewsletterV3","isSubscribed":false,"showPromo":false,"name":"Monthly Edition","description":"Well-written and informative articles that you’ll be excited to read. Find our best content here, including tutorials, hands-on real-world examples, research, and cutting-edge techniques. It’s the best way to learn new things and stay up to date with Towards Data Science. ","collection":{"type":"id","generated":false,"id":"Collection:7f60cf5620c9","typename":"Collection"}},"User:895063a310f4":{"id":"895063a310f4","__typename":"User"},"Collection:7f60cf5620c9.navItems.0":{"title":"Data Science","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fdata-science\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.1":{"title":"Machine Learning","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fmachine-learning\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.2":{"title":"Programming","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fprogramming\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.3":{"title":"Visualization","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fdata-visualization\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.4":{"title":"AI","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fartificial-intelligence\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.5":{"title":"Video","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fvideo\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.6":{"title":"About","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fabout-us\u002Fhome","type":"TOPIC_PAGE","__typename":"NavItem"},"Collection:7f60cf5620c9.navItems.7":{"title":"Contribute","url":"https:\u002F\u002Ftowardsdatascience.com\u002Fcontribute\u002Fhome","type":"EXTERNAL_LINK_NAV_ITEM","__typename":"NavItem"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum":{"backgroundColor":"#FF355876","colorPoints":[{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.0","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.1","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.2","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.3","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.4","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.5","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.6","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.7","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.8","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.9","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.10","typename":"ColorPoint"}],"__typename":"ColorSpectrum"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.0":{"color":"#FF355876","point":0,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.1":{"color":"#FF4D6C88","point":0.1,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.2":{"color":"#FF637F99","point":0.2,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.3":{"color":"#FF7791A8","point":0.3,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.4":{"color":"#FF8CA2B7","point":0.4,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.5":{"color":"#FF9FB3C6","point":0.5,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.6":{"color":"#FFB2C3D4","point":0.6,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.7":{"color":"#FFC5D2E1","point":0.7,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.8":{"color":"#FFD7E2EE","point":0.8,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.9":{"color":"#FFE9F1FA","point":0.9,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum.colorPoints.10":{"color":"#FFFBFFFF","point":1,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette":{"tintBackgroundSpectrum":{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.tintBackgroundSpectrum","typename":"ColorSpectrum"},"__typename":"ColorPalette","highlightSpectrum":{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum","typename":"ColorSpectrum"},"defaultBackgroundSpectrum":{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum","typename":"ColorSpectrum"}},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum":{"backgroundColor":"#FFFFFFFF","colorPoints":[{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.0","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.1","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.2","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.3","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.4","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.5","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.6","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.7","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.8","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.9","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.10","typename":"ColorPoint"}],"__typename":"ColorSpectrum"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.0":{"color":"#FFEDF4FC","point":0,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.1":{"color":"#FFE9F2FD","point":0.1,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.2":{"color":"#FFE6F1FD","point":0.2,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.3":{"color":"#FFE2EFFD","point":0.3,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.4":{"color":"#FFDFEEFD","point":0.4,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.5":{"color":"#FFDBECFE","point":0.5,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.6":{"color":"#FFD7EBFE","point":0.6,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.7":{"color":"#FFD4E9FE","point":0.7,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.8":{"color":"#FFD0E7FF","point":0.8,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.9":{"color":"#FFCCE6FF","point":0.9,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.highlightSpectrum.colorPoints.10":{"color":"#FFC8E4FF","point":1,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum":{"backgroundColor":"#FFFFFFFF","colorPoints":[{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.0","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.1","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.2","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.3","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.4","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.5","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.6","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.7","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.8","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.9","typename":"ColorPoint"},{"type":"id","generated":true,"id":"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.10","typename":"ColorPoint"}],"__typename":"ColorSpectrum"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.0":{"color":"#FF668AAA","point":0,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.1":{"color":"#FF61809D","point":0.1,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.2":{"color":"#FF5A7690","point":0.2,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.3":{"color":"#FF546C83","point":0.3,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.4":{"color":"#FF4D6275","point":0.4,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.5":{"color":"#FF455768","point":0.5,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.6":{"color":"#FF3D4C5A","point":0.6,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.7":{"color":"#FF34414C","point":0.7,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.8":{"color":"#FF2B353E","point":0.8,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.9":{"color":"#FF21282F","point":0.9,"__typename":"ColorPoint"},"$Collection:7f60cf5620c9.colorPalette.defaultBackgroundSpectrum.colorPoints.10":{"color":"#FF161B1F","point":1,"__typename":"ColorPoint"},"$Post:af3738b527c3.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}})":{"isLockedPreviewOnly":false,"validatedShareKey":"","__typename":"PostContent","bodyModel":{"type":"id","generated":true,"id":"$Post:af3738b527c3.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel","typename":"RichText"}},"User:11ca8872d783":{"id":"11ca8872d783","isSuspended":false,"__typename":"User","allowNotes":true,"name":"Max Ghenis","isFollowing":false,"username":"MaxGhenis","bio":"Economist studying at MIT. Focused on poverty, fiscal policy, basic income, and housing. Former Google data scientist.","imageId":"2*7R9HC-rx2qMYDvc5HGIQEQ.jpeg","mediumMemberAt":1563778800000,"isBlocking":false,"isMuting":false,"isPartnerProgramEnrolled":false,"twitterScreenName":"maxghenis"},"machine-learning":{"name":"Machine Learning","slug":"machine-learning","__typename":"Topic","isFollowing":null},"$Post:af3738b527c3.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.sections.0":{"name":"3d0a","startIndex":0,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:af3738b527c3.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.sections.1":{"name":"0c2c","startIndex":60,"textLayout":null,"imageLayout":null,"backgroundImage":null,"videoLayout":null,"backgroundVideo":null,"__typename":"Section"},"$Post:af3738b527c3.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel":{"sections":[{"type":"id","generated":true,"id":"$Post:af3738b527c3.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.sections.0","typename":"Section"},{"type":"id","generated":true,"id":"$Post:af3738b527c3.content({\"postMeteringOptions\":{\"referrer\":\"https:\u002F\u002Fwww.google.com\u002F\"}}).bodyModel.sections.1","typename":"Section"}],"paragraphs":[{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_0","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_1","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_2","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_3","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_4","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_5","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_6","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_7","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_8","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_9","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_10","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_11","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_12","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_13","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_14","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_15","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_16","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_17","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_18","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_19","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_20","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_21","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_22","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_23","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_24","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_25","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_26","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_27","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_28","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_29","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_30","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_31","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_32","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_33","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_34","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_35","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_36","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_37","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_38","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_39","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_40","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_41","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_42","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_43","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_44","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_45","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_46","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_47","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_48","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_49","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_50","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_51","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_52","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_53","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_54","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_55","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_56","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_57","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_58","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_59","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_60","typename":"Paragraph"},{"type":"id","generated":false,"id":"Paragraph:d0422900bcf5_61","typename":"Paragraph"}],"__typename":"RichText"},"Paragraph:d0422900bcf5_0":{"id":"d0422900bcf5_0","name":"793b","type":"H3","href":null,"layout":null,"metadata":null,"text":"Quantile regression, from linear models to trees to deep learning","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_1":{"id":"d0422900bcf5_1","name":"a419","type":"P","href":null,"layout":null,"metadata":null,"text":"Suppose a real estate analyst wants to predict home prices from factors like home age and distance from job centers. The typical goal will be generating the best home price point estimate given those factors, where “best” often refers to the estimate that minimizes squared deviations from reality.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_1.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_1.markups.0":{"type":"EM","start":173,"end":187,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_2":{"id":"d0422900bcf5_2","name":"1c94","type":"P","href":null,"layout":null,"metadata":null,"text":"But what if they want to predict not just a single estimate, but also the likely range? This is called the prediction interval, and the general method for producing them is known as quantile regression. In this post I’ll describe how this problem is formalized; how to implement it in six linear, tree-based, and deep learning methods (in Python — here’s the Jupyter notebook); and how they perform against real-world datasets.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_2.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_2.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_2.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_2.markups.0":{"type":"A","start":348,"end":375,"href":"https:\u002F\u002Fcolab.research.google.com\u002Fdrive\u002F1nXOlrmVHqCHiixqiMF6H8LSciz583_W2","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_2.markups.1":{"type":"EM","start":107,"end":126,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_2.markups.2":{"type":"EM","start":182,"end":201,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_3":{"id":"d0422900bcf5_3","name":"c076","type":"H3","href":null,"layout":null,"metadata":null,"text":"Quantile regression minimizes quantile loss","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_4":{"id":"d0422900bcf5_4","name":"4276","type":"P","href":null,"layout":null,"metadata":null,"text":"Just as regressions minimize the squared-error loss function to predict a single point estimate, quantile regressions minimize the quantile loss in predicting a certain quantile. The most popular quantile is the median, or the 50th percentile, and in this case the quantile loss is simply the sum of absolute errors. Other quantiles could give endpoints of a prediction interval; for example a middle-80-percent range is defined by the 10th and 90th percentiles. The quantile loss differs depending on the evaluated quantile, such that more negative errors are penalized more for higher quantiles and more positive errors are penalized more for lower quantiles.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_4.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_4.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_4.markups.0":{"type":"EM","start":131,"end":145,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_4.markups.1":{"type":"EM","start":300,"end":308,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_5":{"id":"d0422900bcf5_5","name":"4ad2","type":"P","href":null,"layout":null,"metadata":null,"text":"Before digging into the formula, suppose we’ve made a prediction for a single point with a true value of zero, and our predictions range from -1 to +1; that is, our errors also range from -1 to +1. This graph shows how the quantile loss varies with the error, depending on the quantile.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_6":{"id":"d0422900bcf5_6","name":"c653","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:0*ufWnnvTA9AkjKrfI","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*ufWnnvTA9AkjKrfI":{"id":"0*ufWnnvTA9AkjKrfI","originalHeight":894,"originalWidth":1131,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:d0422900bcf5_7":{"id":"d0422900bcf5_7","name":"1550","type":"P","href":null,"layout":null,"metadata":null,"text":"Let’s look at each line separately:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_8":{"id":"d0422900bcf5_8","name":"1565","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The medium blue line shows the median, which is symmetric around zero, where all losses equal zero because the prediction was perfect. Looks good so far: the median aims to bisect the set of predictions, so we want to weigh underestimates equally to overestimates. As we’ll see soon, the quantile loss around the median is half the absolute deviation, so 0.5 at both -1 and +1, and 0 at 0.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_8.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_8.markups.0":{"type":"STRONG","start":0,"end":37,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_9":{"id":"d0422900bcf5_9","name":"12af","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The light blue line shows the 10th percentile, which assigns a lower loss to negative errors and a higher loss to positive errors. The 10th percentile means we think there’s a 10 percent chance that the true value is below that predicted value, so it makes sense to assign less of a loss to underestimates than to overestimates.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_9.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_9.markups.0":{"type":"STRONG","start":0,"end":45,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_10":{"id":"d0422900bcf5_10","name":"953b","type":"ULI","href":null,"layout":null,"metadata":null,"text":"The dark blue line shows the 90th percentile, which is the reverse pattern from the 10th percentile.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_10.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_10.markups.0":{"type":"STRONG","start":0,"end":46,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_11":{"id":"d0422900bcf5_11","name":"1913","type":"P","href":null,"layout":null,"metadata":null,"text":"We can also look at this by quantile for under- and over-estimated predictions. The higher the quantile, the more the quantile loss function penalizes underestimates and the less it penalizes overestimates.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_12":{"id":"d0422900bcf5_12","name":"9e8a","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:0*La2_sFKLXl6Rw16w","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*La2_sFKLXl6Rw16w":{"id":"0*La2_sFKLXl6Rw16w","originalHeight":894,"originalWidth":1131,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:d0422900bcf5_13":{"id":"d0422900bcf5_13","name":"987c","type":"P","href":null,"layout":null,"metadata":null,"text":"Given this intuition, here’s the quantile loss formula (source):","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_13.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_13.markups.0":{"type":"A","start":56,"end":62,"href":"https:\u002F\u002Ftowardsdatascience.com\u002Fdeep-quantile-regression-c85481548b5a","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_14":{"id":"d0422900bcf5_14","name":"f2c0","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:0*sBQtWnFYbxUErMfD","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*sBQtWnFYbxUErMfD":{"id":"0*sBQtWnFYbxUErMfD","originalHeight":57,"originalWidth":284,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:d0422900bcf5_15":{"id":"d0422900bcf5_15","name":"45ca","type":"P","href":null,"layout":null,"metadata":null,"text":"And in Python code, where we can replace the branched logic with a maximum statement:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_15.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_15.markups.0":{"type":"CODE","start":67,"end":74,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_16":{"id":"d0422900bcf5_16","name":"855a","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def quantile_loss(q, y, f):\n  # q: Quantile to be evaluated, e.g., 0.5 for median.\n  # y: True value.\n  # f: Fitted (predicted) value.\n  e = y - f\n  return np.maximum(q * e, (q - 1) * e)","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_17":{"id":"d0422900bcf5_17","name":"d523","type":"P","href":null,"layout":null,"metadata":null,"text":"Next we’ll look at the six methods — OLS, linear quantile regression, random forests, gradient boosting, Keras, and TensorFlow — and see how they work with some real data.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_18":{"id":"d0422900bcf5_18","name":"e45d","type":"H3","href":null,"layout":null,"metadata":null,"text":"The data","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_19":{"id":"d0422900bcf5_19","name":"095a","type":"P","href":null,"layout":null,"metadata":null,"text":"This analysis will use the Boston housing dataset, which contains 506 observations representing towns in the Boston area. It includes 13 features alongside the target, the median value of owner-occupied homes. Quantile regression therefore is predicting the share of towns (not homes) with median home values below a value.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_19.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_19.markups.0":{"type":"A","start":27,"end":49,"href":"https:\u002F\u002Fwww.kaggle.com\u002Fc\u002Fboston-housing","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_20":{"id":"d0422900bcf5_20","name":"d85a","type":"P","href":null,"layout":null,"metadata":null,"text":"I train the models on 80 percent and test on the remaining 20 percent. For easier visualization, the first set of models uses a single feature: AGE, the proportion of owner-occupied units built prior to 1940. As we might expect, towns with older homes have lower home values, though the relationship is noisy.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_20.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_20.markups.0":{"type":"CODE","start":144,"end":147,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_21":{"id":"d0422900bcf5_21","name":"3091","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:0*iWF8FCQyC_Nh2RQ3","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*iWF8FCQyC_Nh2RQ3":{"id":"0*iWF8FCQyC_Nh2RQ3","originalHeight":895,"originalWidth":1153,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:d0422900bcf5_22":{"id":"d0422900bcf5_22","name":"a295","type":"P","href":null,"layout":null,"metadata":null,"text":"For each method, we’ll predict the 10th, 30th, 50th, 70th, and 90th percentiles on the test set.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_23":{"id":"d0422900bcf5_23","name":"9bfa","type":"H3","href":null,"layout":null,"metadata":null,"text":"Ordinary least squares","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_24":{"id":"d0422900bcf5_24","name":"d650","type":"P","href":null,"layout":null,"metadata":null,"text":"Although OLS predicts the mean rather than the median, we can still calculate prediction intervals from it based on standard errors and the inverse normal CDF:","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_25":{"id":"d0422900bcf5_25","name":"62fa","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def ols_quantile(m, X, q):\n  # m: OLS statsmodels model.\n  # X: X matrix.\n  # q: Quantile.\n  mean_pred = m.predict(X)\n  se = np.sqrt(m.scale)\n  return mean_pred + norm.ppf(q) * se","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_26":{"id":"d0422900bcf5_26","name":"d635","type":"P","href":null,"layout":null,"metadata":null,"text":"This baseline approach produces linear and parallel quantiles centered around the mean (which is predicted as the median). A well-tuned model will show about 80 percent of dots in between the top and bottom lines. Note the dots differ from the first scatter plot, as here we’re showing the test set to evaluate out-of-sample predictions.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_27":{"id":"d0422900bcf5_27","name":"fe74","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:0*swvEEDGS68RR0fUb","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*swvEEDGS68RR0fUb":{"id":"0*swvEEDGS68RR0fUb","originalHeight":894,"originalWidth":1187,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:d0422900bcf5_28":{"id":"d0422900bcf5_28","name":"be97","type":"H3","href":null,"layout":null,"metadata":null,"text":"Linear quantile regression","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_29":{"id":"d0422900bcf5_29","name":"bf8b","type":"P","href":null,"layout":null,"metadata":null,"text":"Linear models extend beyond the mean to the median and other quantiles. Linear quantile regression predicts a given quantile, relaxing OLS’s parallel trend assumption while still imposing linearity (under the hood, it’s minimizing quantile loss). This is straightforward with statsmodels :","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_29.markups.0","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_29.markups.0":{"type":"CODE","start":276,"end":287,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_30":{"id":"d0422900bcf5_30","name":"2383","type":"PRE","href":null,"layout":null,"metadata":null,"text":"sm.QuantReg(train_labels, X_train).fit(q=q).predict(X_test)\n# Provide q.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_31":{"id":"d0422900bcf5_31","name":"2b52","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:0*fzc8JnVklM7Gj_Kn","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*fzc8JnVklM7Gj_Kn":{"id":"0*fzc8JnVklM7Gj_Kn","originalHeight":894,"originalWidth":1187,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:d0422900bcf5_32":{"id":"d0422900bcf5_32","name":"3b08","type":"H3","href":null,"layout":null,"metadata":null,"text":"Random forests","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_33":{"id":"d0422900bcf5_33","name":"534a","type":"P","href":null,"layout":null,"metadata":null,"text":"Our first departure from linear models is random forests, a collection of trees. While this model doesn’t explicitly predict quantiles, we can treat each tree as a possible value, and calculate quantiles using its empirical CDF (Ando Saabas has written more on this):","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_33.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_33.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_33.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_33.markups.0":{"type":"A","start":42,"end":56,"href":"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FRandom_forest","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_33.markups.1":{"type":"A","start":214,"end":227,"href":"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FEmpirical_distribution_function","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_33.markups.2":{"type":"A","start":229,"end":265,"href":"https:\u002F\u002Fblog.datadive.net\u002Fprediction-intervals-for-random-forests\u002F","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_34":{"id":"d0422900bcf5_34","name":"4d01","type":"PRE","href":null,"layout":null,"metadata":null,"text":"def rf_quantile(m, X, q):\n  # m: sklearn random forests model.\n  # X: X matrix.\n  # q: Quantile.\n  rf_preds = []\n  for estimator in m.estimators_:\n    rf_preds.append(estimator.predict(X))\n  # One row per record.\n  rf_preds = np.array(rf_preds).transpose()\n  return np.percentile(rf_preds, q * 100, axis=1)","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_35":{"id":"d0422900bcf5_35","name":"9e76","type":"P","href":null,"layout":null,"metadata":null,"text":"It goes a bit crazy in this case, suggesting overfitting. Since random forests are more commonly used for high-dimensional datasets, we’ll return to them after adding more features to the model.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_36":{"id":"d0422900bcf5_36","name":"c289","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:0*9ez_bYKF7SrVOPkK","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*9ez_bYKF7SrVOPkK":{"id":"0*9ez_bYKF7SrVOPkK","originalHeight":894,"originalWidth":1187,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:d0422900bcf5_37":{"id":"d0422900bcf5_37","name":"0557","type":"H3","href":null,"layout":null,"metadata":null,"text":"Gradient boosting","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_38":{"id":"d0422900bcf5_38","name":"1df5","type":"P","href":null,"layout":null,"metadata":null,"text":"Another tree-based method is gradient boosting, scikit-learn’s implementation of which supports explicit quantile prediction:","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_38.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_38.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_38.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_38.markups.0":{"type":"CODE","start":48,"end":60,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_38.markups.1":{"type":"A","start":29,"end":46,"href":"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FGradient_boosting","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_38.markups.2":{"type":"A","start":63,"end":86,"href":"http:\u002F\u002Fscikit-learn.org\u002Fstable\u002Fmodules\u002Fgenerated\u002Fsklearn.ensemble.GradientBoostingRegressor.html","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_39":{"id":"d0422900bcf5_39","name":"c8ae","type":"PRE","href":null,"layout":null,"metadata":null,"text":"ensemble.GradientBoostingRegressor(loss='quantile', alpha=q)","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_40":{"id":"d0422900bcf5_40","name":"7f77","type":"P","href":null,"layout":null,"metadata":null,"text":"While not as jumpy as the random forests, it doesn’t look to do great on the one-feature model either.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_41":{"id":"d0422900bcf5_41","name":"6bf2","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:0*n64W1bkgIYZn-r7W","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*n64W1bkgIYZn-r7W":{"id":"0*n64W1bkgIYZn-r7W","originalHeight":894,"originalWidth":1187,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:d0422900bcf5_42":{"id":"d0422900bcf5_42","name":"e335","type":"H3","href":null,"layout":null,"metadata":null,"text":"Keras (deep learning)","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_43":{"id":"d0422900bcf5_43","name":"a4d0","type":"P","href":null,"layout":null,"metadata":null,"text":"Keras is a user-friendly wrapper for neural network toolkits including TensorFlow. We can use deep neural networks to predict quantiles by passing the quantile loss function. The code is somewhat involved, so check out the Jupyter notebook or read more from Sachin Abeywardana to see how it works.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_43.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_43.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_43.markups.2","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_43.markups.3","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_43.markups.4","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_43.markups.0":{"type":"A","start":0,"end":5,"href":"https:\u002F\u002Fkeras.io\u002F","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_43.markups.1":{"type":"A","start":71,"end":81,"href":"http:\u002F\u002Ftensorflow.org","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_43.markups.2":{"type":"A","start":223,"end":239,"href":"https:\u002F\u002Fcolab.research.google.com\u002Fdrive\u002F1nXOlrmVHqCHiixqiMF6H8LSciz583_W2#scrollTo=g7s7Grj-A-Sf","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_43.markups.3":{"type":"A","start":243,"end":257,"href":"https:\u002F\u002Ftowardsdatascience.com\u002Fdeep-quantile-regression-c85481548b5a","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_43.markups.4":{"type":"A","start":258,"end":276,"href":null,"anchorType":"USER","userId":"4d883eeaf62d","linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_44":{"id":"d0422900bcf5_44","name":"6e58","type":"P","href":null,"layout":null,"metadata":null,"text":"Underlying most deep nets are linear models with kinks (called rectified linear units, or ReLUs), which we can see here visually: Keras predicts more bunching up of home values for towns with about 70 percent built before 1940, while fanning out more at the very low and very high ends of age. This seems to be a good prediction based on fit of the test data.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_44.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_44.markups.1","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_44.markups.0":{"type":"EM","start":63,"end":85,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_44.markups.1":{"type":"EM","start":90,"end":95,"href":null,"anchorType":null,"userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_45":{"id":"d0422900bcf5_45","name":"8fe9","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:0*BkSIs6ycS59UGzlZ","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*BkSIs6ycS59UGzlZ":{"id":"0*BkSIs6ycS59UGzlZ","originalHeight":894,"originalWidth":1187,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:d0422900bcf5_46":{"id":"d0422900bcf5_46","name":"2ee9","type":"H3","href":null,"layout":null,"metadata":null,"text":"TensorFlow","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_47":{"id":"d0422900bcf5_47","name":"7658","type":"P","href":null,"layout":null,"metadata":null,"text":"One disadvantage of Keras is that each quantile must be trained separately. To leverage patterns common to the quantiles, we have to go to TensorFlow itself. See the Jupyter notebook and Jacob Zweig’s article to learn more about this.","hasDropCap":null,"dropCapImage":null,"markups":[{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_47.markups.0","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_47.markups.1","typename":"Markup"},{"type":"id","generated":true,"id":"Paragraph:d0422900bcf5_47.markups.2","typename":"Markup"}],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_47.markups.0":{"type":"A","start":166,"end":182,"href":"https:\u002F\u002Fcolab.research.google.com\u002Fdrive\u002F1nXOlrmVHqCHiixqiMF6H8LSciz583_W2#scrollTo=g7s7Grj-A-Sf","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_47.markups.1":{"type":"A","start":187,"end":198,"href":null,"anchorType":"USER","userId":"4459aa7bce57","linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_47.markups.2":{"type":"A","start":201,"end":208,"href":"https:\u002F\u002Ftowardsdatascience.com\u002Fdeep-quantile-regression-in-tensorflow-1dbc792fe597","anchorType":"LINK","userId":null,"linkMetadata":null,"__typename":"Markup"},"Paragraph:d0422900bcf5_48":{"id":"d0422900bcf5_48","name":"1a7b","type":"P","href":null,"layout":null,"metadata":null,"text":"We can see this co-learning across the quantiles in its predictions, where the model learns a common kink rather than separate ones for each quantile. This looks to be a good Occam-inspired choice.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_49":{"id":"d0422900bcf5_49","name":"8911","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:0*jACva6ArwF4L_Vwt","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*jACva6ArwF4L_Vwt":{"id":"0*jACva6ArwF4L_Vwt","originalHeight":894,"originalWidth":1187,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:d0422900bcf5_50":{"id":"d0422900bcf5_50","name":"f037","type":"H3","href":null,"layout":null,"metadata":null,"text":"Which did best?","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_51":{"id":"d0422900bcf5_51","name":"715d","type":"P","href":null,"layout":null,"metadata":null,"text":"Eyeballing suggests that deep learning did well, linear models did OK, and tree-based methods did poorly, but can we quantify which is best? Yes we can, using quantile loss over the test set.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_52":{"id":"d0422900bcf5_52","name":"b21b","type":"P","href":null,"layout":null,"metadata":null,"text":"Recall that the quantile loss differs depending on the quantile. Since we calculated five quantiles, we have five quantile losses for each observation in the test set. Averaging over all quantile-observations confirms the visual intuition: random forests did worst, while TensorFlow did best.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_53":{"id":"d0422900bcf5_53","name":"668c","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:0*TE_SIChhR9fSV9bO","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*TE_SIChhR9fSV9bO":{"id":"0*TE_SIChhR9fSV9bO","originalHeight":894,"originalWidth":1275,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:d0422900bcf5_54":{"id":"d0422900bcf5_54","name":"a109","type":"P","href":null,"layout":null,"metadata":null,"text":"We can also break this out by quantile, revealing that tree-based methods did especially poorly at the 90th percentile, while deep learning did best at the lower quantiles.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_55":{"id":"d0422900bcf5_55","name":"16d5","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:0*SmMb_wtpgU2Kxnf2","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*SmMb_wtpgU2Kxnf2":{"id":"0*SmMb_wtpgU2Kxnf2","originalHeight":894,"originalWidth":1131,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:d0422900bcf5_56":{"id":"d0422900bcf5_56","name":"181d","type":"H3","href":null,"layout":null,"metadata":null,"text":"Larger datasets give more opportunity to improve over OLS","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_57":{"id":"d0422900bcf5_57","name":"31e6","type":"P","href":null,"layout":null,"metadata":null,"text":"So random forests was awful for this one-feature dataset, but that’s not what they’re made for. What happens if we add the other 12 features to the Boston housing model?","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_58":{"id":"d0422900bcf5_58","name":"dfb7","type":"IMG","href":null,"layout":"INSET_CENTER","metadata":{"type":"id","generated":false,"id":"ImageMetadata:0*ybjeY9K-tED8hfbD","typename":"ImageMetadata"},"text":"","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"ImageMetadata:0*ybjeY9K-tED8hfbD":{"id":"0*ybjeY9K-tED8hfbD","originalHeight":894,"originalWidth":1291,"focusPercentX":null,"focusPercentY":null,"alt":null,"__typename":"ImageMetadata"},"Paragraph:d0422900bcf5_59":{"id":"d0422900bcf5_59","name":"e2ec","type":"P","href":null,"layout":null,"metadata":null,"text":"The tree-based methods made a comeback, and while the OLS improved, the gap between OLS and other non-tree methods grew.","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_60":{"id":"d0422900bcf5_60","name":"f1d1","type":"P","href":null,"layout":null,"metadata":null,"text":"Real-world problems often extend beyond predicting means. Maybe an app developer is interested not only in users’ expected usage, but also their probability of becoming super-users. Or an auto insurance company wants to know the chance of a driver’s high-value claim at different thresholds. Economists might want to stochastically impute information from one dataset onto another, picking from the CDF to ensure proper variation (an example I’ll explore in a follow-up post).","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Paragraph:d0422900bcf5_61":{"id":"d0422900bcf5_61","name":"4b00","type":"P","href":null,"layout":null,"metadata":null,"text":"Quantile regression is valuable for each of these use cases, and machine learning tools can often outperform linear models, especially the easy-to-use tree-based methods. Try it out on your own data and let me know how it goes!","hasDropCap":null,"dropCapImage":null,"markups":[],"__typename":"Paragraph","iframe":null,"mixtapeMetadata":null},"Tag:machine-learning":{"id":"machine-learning","displayTitle":"Machine Learning","__typename":"Tag"},"Tag:predictive-analytics":{"id":"predictive-analytics","displayTitle":"Predictive Analytics","__typename":"Tag"},"Tag:deep-learning":{"id":"deep-learning","displayTitle":"Deep Learning","__typename":"Tag"},"Tag:regression":{"id":"regression","displayTitle":"Regression","__typename":"Tag"},"Tag:tensorflow":{"id":"tensorflow","displayTitle":"TensorFlow","__typename":"Tag"},"1eca0103fff3":{"topicId":"1eca0103fff3","name":"Machine Learning","__typename":"Topic","slug":"machine-learning"},"ae5d4995e225":{"topicId":"ae5d4995e225","name":"Data Science","__typename":"Topic","slug":"data-science"},"$Post:af3738b527c3.postResponses":{"count":6,"__typename":"PostResponses"},"$Post:af3738b527c3.previewContent":{"subtitle":"Suppose a real estate analyst wants to predict home prices from factors like home age and distance from job centers. The typical goal will…","__typename":"PreviewContent"}}</script><script src="./Quantile regression, from linear models to trees to deep learning_files/manifest.e07e9e5b.js.download"></script><script src="./Quantile regression, from linear models to trees to deep learning_files/vendors_main.a99cd09e.chunk.js.download"></script><script src="./Quantile regression, from linear models to trees to deep learning_files/main.ad8f1534.chunk.js.download"></script><script src="./Quantile regression, from linear models to trees to deep learning_files/vendors_instrumentation.43e69c0d.chunk.js.download"></script>
<script src="./Quantile regression, from linear models to trees to deep learning_files/instrumentation.e6230167.chunk.js.download"></script>
<script src="./Quantile regression, from linear models to trees to deep learning_files/reporting.5c294ac2.chunk.js.download"></script>
<script src="./Quantile regression, from linear models to trees to deep learning_files/vendors_AMPPost_CollectionHomepage_CollectionHomepagePreview_CollectionNewShortformEditor_Collection_37c9fa1e.77e6fe9c.chunk.js.download"></script>
<script src="./Quantile regression, from linear models to trees to deep learning_files/vendors_AMPPost_DebugCachedPost_Post_SequencePost_Series.0bf77567.chunk.js.download"></script>
<script src="./Quantile regression, from linear models to trees to deep learning_files/AMPPost_CollectionHomepage_CollectionHomepagePreview_CollectionNewShortformEditor_CollectionPostShor_3fa3f642.feb0a540.chunk.js.download"></script>
<script src="./Quantile regression, from linear models to trees to deep learning_files/AMPPost_CollectionHomepage_CollectionHomepagePreview_DebugCachedPost_PackageBuilder_Post_SequenceLib_32b7ff81.8ab67ca0.chunk.js.download"></script>
<script src="./Quantile regression, from linear models to trees to deep learning_files/Post.3b62fa05.chunk.js.download"></script><script>window.main();</script><script src="./Quantile regression, from linear models to trees to deep learning_files/p.js.download" async="" id="parsely-cf"></script><iframe src="./Quantile regression, from linear models to trees to deep learning_files/a16180790160.html" hidden="" tabindex="-1" title="Optimizely Internal Frame" height="0" width="0" style="display: none;"></iframe></body></html>